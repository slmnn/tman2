!function(){"use strict";angular.module("frontend.admin.login-history",[]),angular.module("frontend.admin.login-history").config(["$stateProvider",function(t){t.state("admin.login-history",{url:"/admin/loginHistory",views:{"content@":{templateUrl:"/frontend/admin/loginHistory/index.html",controller:"LoginHistoryController",name:"Kirjautumishistoria",resolve:{_items:["ListConfig","LoginHistoryModel",function(t,e){var a=t.getConfig(),r={limit:a.itemsPerPage,sort:"createdAt DESC",populate:"user"};return e.load(r)}],_count:["LoginHistoryModel",function(t){return t.count()}],_statsBrowser:["LoginHistoryModel",function(t){return t.statistics("Browser")}],_statsOS:["LoginHistoryModel",function(t){return t.statistics("OS")}],_statsUser:["LoginHistoryModel",function(t){return t.statistics("User")}]}}}})}])}(),function(){"use strict";angular.module("frontend.admin.migrate",[]),angular.module("frontend.admin.migrate").config(["$stateProvider",function(t){t.state("admin.migrate",{url:"/app/migrate",views:{"content@":{templateUrl:"/frontend/admin/migrate/migrate.html",controller:"MigrateController",name:"Migraatio",resolve:{_territories:["TerritoryModel",function(t){return t.load()}],_app:["$stateParams","AppModel",function(t,e){return e.load()}],_holders:["$stateParams","HolderModel",function(t,e){return e.load()}]}}}})}])}(),function(){"use strict";angular.module("frontend.admin.request-log",[]),angular.module("frontend.admin.request-log").config(["$stateProvider",function(t){t.state("admin.request-log",{url:"/admin/requestlog",views:{"content@":{templateUrl:"/frontend/admin/requestlog/index.html",controller:"RequestLogController",name:"Taustakyselyt",resolve:{_items:["ListConfig","RequestLogModel",function(t,e){var a=t.getConfig(),r={limit:a.itemsPerPage,sort:"createdAt DESC",populate:"user"};return e.load(r)}],_count:["RequestLogModel",function(t){return t.count()}]}}}})}])}(),function(){"use strict";angular.module("frontend.admin.user",[]),angular.module("frontend.admin.user").config(["$stateProvider",function(t){t.state("admin.user",{url:"/admin/user/",views:{"content@":{templateUrl:"/frontend/admin/user/index.html",controller:"UsersController",name:"Käyttäjät",resolve:{_items:["ListConfig","UserModel",function(t,e){var a=t.getConfig(),r={limit:a.itemsPerPage,sort:"createdAt DESC",populate:"holder"};return e.load(r)}],_count:["UserModel",function(t){return t.count()}]}}}}).state("admin.user.add",{url:"/add",views:{"content@":{templateUrl:"/frontend/admin/user/add.html",controller:"UserAddController",name:"Käyttäjän lisääminen",resolve:{_app:["$stateParams","AppModel",function(t,e){return e.load({populate:"defaultHolder"})}],_holders:["$stateParams","HolderModel",function(t,e){return e.load()}]}}}}).state("admin.user.single",{url:"/:id",views:{"content@":{templateUrl:"/frontend/admin/user/user.html",controller:"UserController",name:"Käyttäjän tiedot",resolve:{_user:["$stateParams","UserModel",function(t,e){return e.fetch(t.id,{populate:"holder"})}],_app:["$stateParams","AppModel",function(t,e){return e.load({populate:"defaultHolder"})}],_holders:["$stateParams","HolderModel",function(t,e){return e.load()}]}}}})}])}(),function(){"use strict";angular.module("frontend.app.about",[]),angular.module("frontend.app.about").config(["$stateProvider",function(t){t.state("app.about",{url:"/about",data:{access:0},views:{"content@":{templateUrl:"/frontend/app/about/about.html",controller:"AboutController",resolve:{_app:["$stateParams","AppModel",function(t,e){return e.load()}]}},"pageNavigation@":!1}})}]).controller("AboutController",["$scope","$state","AuthService","_app",function(t,e,a,r){t.auth=a,t.name=r[0].name}])}(),function(){"use strict";angular.module("frontend.app.app",[]),angular.module("frontend.app.app").config(["$stateProvider",function(t){t.state("app.settings",{url:"/app/settings/",views:{"content@":{templateUrl:"/frontend/app/app/app.html",controller:"AppController",name:"Aluehallinnan asetukset",resolve:{_holders:["$stateParams","HolderModel",function(t,e){return e.load()}],_app:["$stateParams","AppModel",function(t,e){return e.load({populate:"defaultHolder"})}]}}}})}])}(),function(){"use strict";angular.module("frontend.app.attribute",[]),angular.module("frontend.app.attribute").config(["$stateProvider",function(t){t.state("app.attributes",{url:"/app/attributes/",views:{"content@":{templateUrl:"/frontend/app/attributes/attributes.html",controller:"AttributesController",name:"Attribuutit",resolve:{_attributes:["$stateParams","AttributeModel",function(t,e){return e.load()}]}}}})}])}(),function(){"use strict";angular.module("frontend.app.chat",[]),angular.module("frontend.app.chat").config(["$stateProvider",function(t){t.state("app.chat",{url:"/app/chat",views:{"content@":{templateUrl:"/frontend/app/chat/chat.html",controller:"ChatController",resolve:{_messages:["$localStorage","moment","MessageModel",function(t,e,a){var r={where:{createdAt:{">":t.chat&&t.chat.time?t.chat.time:e().format()}}};return a.load(r)}]}}}})}])}(),function(){"use strict";angular.module("frontend.app.coordinate",[]),angular.module("frontend.app.coordinate").service("CoordinateModel",["DataModel",function(t){return new t("coordinate")}])}(),function(){"use strict";angular.module("frontend.app.holder",[]),angular.module("frontend.app.holder").config(["$stateProvider",function(t){t.state("app.holder",{url:"/app/holder",views:{"content@":{templateUrl:"/frontend/app/holder/list.html",controller:"HolderListController",name:"Alueomistajat",resolve:{_items:["ListConfig","HolderModel",function(t,e){var a=t.getConfig(),r={populate:"territories",limit:a.itemsPerPage,sort:"name ASC"};return e.load(r)}],_count:["HolderModel",function(t){return t.count()}],_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}}).state("app.holder.add",{url:"/add",data:{access:2},views:{"content@":{templateUrl:"/frontend/app/holder/add.html",controller:"HolderAddController",name:"Alueomistajan lisääminen",resolve:{_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}}).state("app.holder.single",{url:"/:id",views:{"content@":{templateUrl:"/frontend/app/holder/holder.html",controller:"HolderController",name:"Alueomistajan tiedot",resolve:{_holder:["$stateParams","HolderModel",function(t,e){return e.fetch(t.id,{populate:"territories"})}],_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}})}])}(),function(){"use strict";angular.module("frontend.app.messages",[]),angular.module("frontend.app.messages").config(["$stateProvider",function(t){t.state("app.messages",{url:"/app/messages",views:{"content@":{templateUrl:"/frontend/app/messages/messages.html",controller:"MessagesController"}}})}])}(),function(){"use strict";angular.module("frontend.app.specialAddress",[]),angular.module("frontend.app.specialAddress").service("SpecialAddressModel",["DataModel",function(t){return new t("specialAddress")}])}(),function(){"use strict";angular.module("frontend.app.stat",[]),angular.module("frontend.app.stat").service("StatModel",["DataModel",function(t){return new t("stat")}])}(),function(){"use strict";angular.module("frontend.app.territoryHolderHistory",[])}(),function(){"use strict";angular.module("frontend.app.territoryLinkAttribute",[]),angular.module("frontend.app.territoryLinkAttribute").service("TerritoryLinkAttributeModel",["DataModel",function(t){return new t("territoryLinkAttribute")}])}(),function(){"use strict";angular.module("frontend.app.territory",[]),angular.module("frontend.app.territory").config(["$stateProvider",function(t){t.state("app.territory",{url:"/app/territory",views:{"content@":{templateUrl:"/frontend/app/territory/list.html",controller:"TerritoryListController",name:"Aluelistaus",resolve:{_items:["ListConfig","TerritoryModel",function(t,e){var a=t.getConfig(),r={populate:["holder","territoryHolderHistory","territoryLinkAttribute"],limit:a.itemsPerPage,sort:"territoryCode ASC"};return e.load(r)}],_holders:["$stateParams","HolderModel",function(t,e){return e.load({where:{isArchived:!1},sort:"name ASC"})}],_attributes:["$stateParams","AttributeModel",function(t,e){return e.load()}],_count:["TerritoryModel",function(t){return t.count()}],_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}}).state("app.territory.s13",{url:"/s13",views:{"content@":{templateUrl:"/frontend/app/territory/s13.html",controller:"TerritoryS13Controller",name:"S13-lomake",resolve:{_items:["ListConfig","TerritoryModel",function(t,e){var a=(t.getConfig(),{populate:["holder","territoryHolderHistory"],limit:999,sort:"territoryCode ASC"});return e.load(a)}],_holders:["$stateParams","HolderModel",function(t,e){return e.load()}]}}}}).state("app.territory.stats",{url:"/stats",views:{"content@":{templateUrl:"/frontend/app/territory/stats.html",controller:"TerritoryStatsController",name:"Tilastot",resolve:{_items:["ListConfig","TerritoryModel",function(t,e){var a=(t.getConfig(),{populate:["territoryHolderHistory"],limit:999,sort:"territoryCode ASC"});return e.load(a)}],_app:["$stateParams","AppModel",function(t,e){return e.load()}],_stats:["$stateParams","StatModel",function(t,e){return e.load()}]}}}}).state("app.territory.map",{url:"/map",views:{"content@":{templateUrl:"/frontend/app/territory/map.html",controller:"TerritoryMapController",name:"Kartta",resolve:{_items:["ListConfig","TerritoryModel",function(t,e){var a=(t.getConfig(),{populate:["holder","center"],limit:999,sort:"name ASC"});return e.load(a)}],_holders:["$stateParams","HolderModel",function(t,e){return e.load()}],_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}}).state("app.territory.quickview",{url:"/quickview",views:{"content@":{templateUrl:"/frontend/app/territory/quickview.html",controller:"TerritoryQuickViewController",name:"Pikatarkastelu",resolve:{_items:["ListConfig","TerritoryModel",function(t,e){var a=(t.getConfig(),{populate:["holder","center"],sort:"name ASC"});return e.load(a)}],_holders:["$stateParams","HolderModel",function(t,e){return e.load()}],_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}}).state("app.territory.add",{url:"/add",data:{access:2},onEnter:["$stateParams","$state","$modal",function(t,e,a){a.open({templateUrl:"/frontend/app/territory/add.html",resolve:{_holders:["HolderModel",function(t){return t.load({where:{isArchived:!1},sort:"name ASC"})}],_app:["AppModel",function(t){return t.load()}]},controller:"TerritoryAddController",name:"Uusi alue"}).result["finally"](function(){e.go("^")})}]}).state("app.territory.single",{url:"/:id",views:{"content@":{templateUrl:"/frontend/app/territory/territory.html",controller:"TerritoryController",name:"Alueen tiedot",resolve:{_territory:["$stateParams","TerritoryModel",function(t,e){return e.fetch(t.id,{populate:["holder","territoryHolderHistory","center","coordinates","territoryLinkAttribute","specialAddress"]})}],_attributes:["$stateParams","AttributeModel",function(t,e){return e.load()}],_holders:["$stateParams","HolderModel",function(t,e){return e.load({sort:"name ASC"})}],_holdersCount:["$stateParams","HolderModel",function(t,e){return e.count({territory:t.id})}],_app:["$stateParams","AppModel",function(t,e){return e.load()}]}}}})}])}(),angular.module("ngLocale",[],["$provide",function(t){function e(t){t+="";var e=t.indexOf(".");return-1==e?0:t.length-e-1}function a(t,a){var r=a;void 0===r&&(r=Math.min(e(t),3));var n=Math.pow(10,r),i=(t*n|0)%n;return{v:r,f:i}}var r={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};t.value("$locale",{DATETIME_FORMATS:{AMPMS:["ap.","ip."],DAY:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ERANAMES:["ennen Kristuksen syntymää","jälkeen Kristuksen syntymän"],ERAS:["eKr.","jKr."],FIRSTDAYOFWEEK:0,MONTH:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kesäkuuta","heinäkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],SHORTDAY:["su","ma","ti","ke","to","pe","la"],SHORTMONTH:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kesäkuuta","heinäkuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],STANDALONEMONTH:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],WEEKENDRANGE:[5,6],fullDate:"cccc d. MMMM y",longDate:"d. MMMM y",medium:"d.M.y H.mm.ss",mediumDate:"d.M.y",mediumTime:"H.mm.ss","short":"d.M.y H.mm",shortDate:"d.M.y",shortTime:"H.mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"fi-fi",pluralCat:function(t,e){var n=0|t,i=a(t,e);return 1==n&&0==i.v?r.ONE:r.OTHER}})}]),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("../moment")):"function"==typeof define&&define.amd?define(["moment"],e):e(t.moment)}(this,function(t){"use strict";function e(t,e,a,r){var n={m:["minuutti","minuutin"],mm:[t+" minuuttia",t+" minuutin"],h:["tunti","tunnin"],hh:[t+" tuntia",t+" tunnin"],d:["päivä","päivän"],dd:[t+" päivää",t+" päivän"],M:["kuukausi","kuukauden"],MM:[t+" kuukautta",t+" kuukauden"],y:["vuosi","vuoden"],yy:[t+" vuotta",t+" vuoden"]};return r?n[a][1]:n[a][0]}var a=t.defineLocale("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] LT",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] LT",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] LT",llll:"ddd, Do MMM YYYY, [klo] LT"},calendar:{sameDay:"[tänään] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s päästä",past:"%s sitten",s:"hetki",m:e,mm:e,h:e,hh:e,d:e,dd:e,M:e,MM:e,y:e,yy:e},ordinalParse:/\d{1,2}\./,ordinal:"%d.",week:{dow:1,doy:4}});return a}),function(){"use strict";angular.module("frontend.core.auth.services",[])}(),function(){"use strict";angular.module("frontend.core.components",[])}(),function(){"use strict";angular.module("frontend.core.dependencies",["angular-loading-bar","ngAnimate","ngSanitize","ngBootbox","ngStorage","ui.router","ui.bootstrap","ui.bootstrap.showErrors","ui.utils","angularMoment","toastr","xeditable","sails.io","uiGmapgoogle-maps","highcharts-ng","pascalprecht.translate"])}(),function(){"use strict";angular.module("frontend.core.directives",[]),angular.module("frontend.core.directives").directive("datepickerPopup",function(){return{restrict:"EAC",require:"ngModel",link:function(t,e,a,r){r.$formatters.shift()}}}).directive("territorySubPages",function(){return{templateUrl:"/frontend/core/directives/partials/territorySubPages.html"}})}(),function(){"use strict";angular.module("frontend.core.error",[]),angular.module("frontend.core.error").config(["$stateProvider",function(t){t.state("error",{parent:"frontend",url:"/error",data:{access:0},views:{"content@":{templateUrl:"/frontend/core/error/partials/error.html",controller:"ErrorController",resolve:{_error:function(){return this.self.error}}}}})}])}(),function(){"use strict";angular.module("frontend.core.filters",[])}(),function(){"use strict";angular.module("frontend.core.i18n",[]),angular.module("frontend.core.i18n").config(["$translateProvider",function(t){t.preferredLanguage("fi"),t.useSanitizeValueStrategy("sanitize"),t.translations("fi",{TITLE:"Aluesovellus v2.0",EDIT:"Muokkaa",SAVE:"Tallenna",CANCEL:"Peruuta",DELETE:"Poista",ADD:"Lisää",FIRST:"Ensimmäinen",PREVIOUS:"Edellinen",NEXT:"Seuraava",LAST:"Viimeinen",EMAIL:"Sähköpostiosoite",EMAIL_ADDRESS_IS_IN_USE:"Sähköpostiosoite on käytössä",USER_NOT_FOUND:"Käyttäjää ei löydy",NEW_PASSWORD:"Uusi salasana",REPEAT_PASSWORD:"Toista uusi salasana",SAVE_PASSWORD:"Tallenna salasana",NEW_PASSWORD_HINT:"Syötä uusi salasanasi tähän",REPEAT_NEW_PASSWORD_HINT:"Syötä uusi salasanasi uudemman kerran",NEW_HOLDER_HISTORY_ADDED_SUCCESS:"Alueen historiatieto lisätty.",HOLDER_HISTORY_UPDATED_SUCCESS_1:"Alueen ",HOLDER_HISTORY_UPDATED_SUCCESS_2:" historiatieto päivitetty.",HOLDER_HISTORY_REMOVED_SUCCESS_2:" historiatieto poistettu.",HOLDER:"Alueomistaja",COVERED:"Käyty",TAKEN:"Omistajalle",TYPE:"Tyyppi",NUMBER_OF_APARTMENTS:"Asuntoja",ARCHIVED:"Arkistoitu",DESCRIPTION:"Kuvaus",NOT_COUNTED_WHEN_CALCULATING_POORLY_COVERED:"Lasketaanko vuoteen käymättömiä alueita laskettaessa",NOT_COUNTED_WHEN_CALCULATING_POORLY_COVERED_2:"Ohitetaanko alue, kun lasketaan yhteen vuoteen käymättömät alueet?",DELETING_TERRITORY_HISTORY_ROW:"Olet poistamassa aluehistoriatietoa.",DELETING_TERRITORY:"Olet poistamassa aluetta ",ARE_YOU_SURE:"Oletko varma?",TERRITORY_NOT_FOUND:"Aluetta ei löydy",NO_HOLDER_HISTORY:"Alueella ei ole historiatietoja.",HISTORY:"Alueen historia",START_DATE:"Alkupäivä",END_DATE:"Loppupäivä",ADDITIONAL_INFO:"Lisätiedot",ADDITIONAL_COMMENT:"Lisää kommentti tähän",NO_TERRITORY_ATTRIBUTES:"Alueella ei ole attribuutteja",ADD_ATTRIBUTE:"Lisää attribuutti",ATTRIBUTES:"Attribuutit",NAME:"Nimi",ATTRIBUTE_DESCRIPTION:"Kuvaus",DELETE_BORDER:"Aseta rajat alkutilaan",SAVE_MAP:"Tallenna kartta",TERRITORY:"Alue",TERRITORY_LIST:"Aluekorttiluettelo",MAP:"Kartta",QUICK_VIEW:"Pikatarkastelu",TERRITORY_CODE:"Aluekoodi",INITIAL_HOLDER:"Ensimmäinen alueomistaja",TERRITORIES:"Alueet",CLEAR_SELECTION:"Poista valinta kaikista",OPERATIONS_FOR_SELECTED_TERRITORIES:"Valitut alueet",MARK_COVERED_NO_HOLDER_CHANGE:"Merkistse alue käydyksi vaihtamatta alueomistajaa",CHANGE_HOLDER_MARK_COVERED:"Vaihda alueomistajaa ja merkitse merkitse alue käydyksi",CHANGE_HOLDER_NOT_MARK_COVERED:"Vaihda alueomistajaa merkitsemättä aluetta käydyksi",TERRITORY_HELP_1:"Joissakin tilanteissa saattaa olla tarpeen lisätä alueen käymiseen tai palautukseen liittyvä kommentti. Esimerkiksi, myöhemmin voi olla hyödyllistä tietää että alueelle on levitetty muistonvietto- tai konventtikutsut. Kirjoita kommentti sille varttuun tilaan. Kommentti ei ole pakollinen.",TERRITORY_HELP_2:"Alueen voi merkitä käydyksi niin että se jää nykyiselle alueomistajalle. Valitse silloin 'Merkitse alue käydyksi vaihtamatta alueomistajaa' -painike.",TERRITORY_HELP_3:"Jos haluat vaihtaa alueomistajan, toimi seuraavasti:",TERRITORY_LI_1:"Valitse uusi alueomistaja alasvetovalikosta.",TERRITORY_LI_2:"Vaihda alueomistaja ja merkitse alue käydyksi valitsemalla 'Vaihda alueomistajaa ja merkitse merkitse alue käydyksi' -painike. Jos et halua että alue merkitään samalla käydyksi, valitse 'Vaihda alueomistajaa merkitsemättä aluetta käydyksi'-painike.",HOLDER_DESCRIPTION:"Lisätiedot",HOLDER_TELEPHONE:"Puhelinnumero",HOLDER_EMAIL:"Sähköpostiosoite",HOLDER_EMAIL_IN_USE:"Sähköpostiosoite käytössä",HOLDER_NAME:"Alueomistajan nimi",HOLDER_NOT_FOUND:"Alueomistajaa ei löydy"}),t.preferredLanguage("fi")}])}(),function(){"use strict";angular.module("frontend.core.interceptors",[])}(),function(){"use strict";angular.module("frontend.core.layout",[])}(),function(){"use strict";angular.module("frontend.core.libraries",[])}(),function(){"use strict";angular.module("frontend.core.models",[])}(),function(){"use strict";angular.module("frontend.core.services",[])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/profile/profile.html",'<div data-ng-show="!user"><h3>{{\'USER_NOT_FOUND\' | translate}}</h3></div><div data-ng-show="user"><form class="form-vertical" role="form" data-editable-form name="editableForm" data-onaftersave="saveUser()"><div class="row"><div class="col-sm-4"><h3>{{user.firstName}} {{user.lastName}} <span class="pull-right" data-ng-show="!editableForm.$visible"><a href="#" data-ng-click="editableForm.$show()" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h3><dl><dt>{{\'EMAIL\' | translate}}</dt><dd><span style="width: 100%" data-editable-text="user.email" data-e-name="user.email" data-e-required>{{user.email}}</span></dd><dl><div><div data-ng-show="editableForm.$visible"><button type="submit" class="btn btn-primary" data-ng-disabled="editableForm.$waiting">{{\'SAVE\' | translate}}</button> <button type="button" class="btn btn-default" data-ng-disabled="editableForm.$waiting" data-ng-click="editableForm.$cancel()">{{\'CANCEL\' | translate}}</button></div></div></dl></dl></div></div></form><form class="form-vertical" role="form" name="passwordForm" data-ng-submit="saveNewPassword()"><div class="row"><div class="col-sm-4"><div class="form-group" style="margin-top: 10px">{{\'NEW_PASSWORD\' | translate}}: <input type="password" class="form-control" name="password1" required placeholder="{{\'NEW_PASSWORD_HINT\' | translate}}" minlength="8" data-ng-model="password1"></div><div class="form-group" style="margin-top: 10px">{{\'REPEAT_PASSWORD\' | translate}}: <input type="password" class="form-control" name="password2" required placeholder="{{\'REPEAT_NEW_PASSWORD_HINT\' | translate}}" data-ng-model="password2"></div><div><input type="submit" class="btn btn-primary" data-ng-disabled="password1 == null || password1 != password2" value="{{\'SAVE_PASSWORD\' | translate}}"></div></div></div></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/loginHistory/index-info.html","<p>Tällä sivulla näet sovellukseen tulleet kirjautumiset.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/loginHistory/index.html",'<h3>Kirjautumishistoria ({{itemCount}})</h3><div class="row"><div class="col-sm-12"><list-search data-filters="filters" data-options="itemsPerPageOptions" data-items="itemsPerPage"></list-search></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div><table class="table table-hover"><thead class="noSelect"><tr><th class="text-nowrap {{item.class}}" data-ng-repeat="item in titleItems"><a data-ng-show="item.column" data-ng-click="changeSort(item)" data-ng-bind-html="item.title"></a> <span data-ng-show="!item.column" data-ng-bind-html="item.title"></span> <i class="fa" data-ng-show="sort.column == item.column" data-ng-class="{\'fa-angle-down\': !sort.direction, \'fa-angle-up\': sort.direction}"></i></th></tr></thead><tbody><tr data-ng-repeat="item in items"><td class="col-xs-2">{{item.ip}}</td><td class="col-xs-2">{{item.browser}}</td><td class="col-xs-2">{{item.os}}</td><td class="col-xs-2">{{item.user.lastName}}, {{item.user.firstName}} <span class="text-muted">({{item.user.username}})</span></td><td class="col-xs-4">{{item.createdAt | amDateFormat : \'LLLL\'}}, <span data-am-time-ago="item.createdAt"></span></td></tr><tr data-ng-if="items.length === 0"><td colspan="100%" class="text-center text-muted"><em>Ei käyttäjiä</em></td></tr></tbody></table><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/migrate/migrate-info.html",'<p>Tällä sivulla voit tehdä migraation vanhasta aluesovelluksesta uuteen.</p><p><ol><li>Tee ensin sovelluksen oletusomistaja (Aluepöytä) ja aseta se sovelluksen asetuksissa oletusomistajaksi.</li><li>Kopioi varmuuskopiosta alueomistajadata ylempään tekstiruutuun. Paina ko. ruudun alta "Tallenna".</li><li>Kopioi varmuuskopiosta aluedata alempaan tekstiruutuun. Paina alemman ruudun alta "Tallenna"</li><li>HUOM! Tarkista tietokannassa, että luontitieto on oikein tehdyillä alueilla ja alueomistajilla. Katso alta hyödyllisiä komentoja.</li></ol><ul><li>Kantaan:<pre>use dbname</pre></li><li>Näytä taulut:<pre>show collections</pre></li><li>Näytä käyttäjät:<pre>show users</pre></li><li>Haku:<pre>db.collectionname.find({kenttä:"arvo"})</pre></li><li>Hae alueet joilla luontitieto pielessä:<pre>db.territory.find({createdId:null})</pre></li><li>Omistajan päivittäminen:<pre>db.territory.update({createdUserId: null}, { $set: { createdUserId: ObjectId("56670a58ff3e4c41d81e9adb")}}, false, true);</pre></li></ul></p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/migrate/migrate.html",'<h1>Migraatio</h1><p>Huom! Oletusalueomistaja täytyy luoda ja asettaa oletusomistajaksi ennen migraation ajamista.</p><form class="form-vertical col-md-12" role="form" name="migrateForm" data-ng-submit="parseMigrationHolders(migrationData)">Alueomistajadata<br><textarea data-ng-model="migrationData.holders" cols="120" rows="10">\n\n    </textarea><br><button type="submit" class="btn btn-primary">Tallenna</button></form><form class="form-vertical col-md-12" role="form" name="migrateForm" data-ng-submit="parseMigrationTerritories(migrationData)">Aluedata<br><textarea data-ng-model="migrationData.territories" cols="120" rows="10">\n\n    </textarea><br><button type="submit" class="btn btn-primary">Tallenna</button></form><hr><button data-ng-click="rollback()" class="btn btn-primary">Poista juuri luodut</button>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/requestlog/index-info.html",'<p>Tällä sivulla voit selata taustajärjestelmään lähetettyjä POST-, PUT- ja DELETE pyyntöjä. Voit avata pyynnön sisällön "näytä / piilota" -linkistä</p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/requestlog/index.html",'<h3>Taustakyselyhistoria ({{itemCount}})</h3><div class="row"><div class="col-sm-12 list-search"><list-search data-filters="filters" data-options="itemsPerPageOptions" data-items="itemsPerPage"></list-search></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div><table class="table table-hover"><thead class="noSelect"><tr><th class="text-nowrap {{item.class}}" data-ng-repeat="item in titleItems"><a data-ng-show="item.column" data-ng-click="changeSort(item)" data-ng-bind-html="item.title"></a> <span data-ng-show="!item.column" data-ng-bind-html="item.title"></span> <i class="fa" data-ng-show="sort.column == item.column" data-ng-class="{\'fa-angle-down\': !sort.direction, \'fa-angle-up\': sort.direction}"></i></th></tr></thead><tbody><tr data-ng-repeat="item in items"><td class="col-xs-2">{{item.createdAt | date : \'dd.MM.yyyy\'}}, <span data-am-time-ago="item.createdAt"></span></td><td class="col-xs-1">{{item.method}}</td><td class="col-xs-2"><span data-ng-if="item.url.length > 100">{{item.url | limitTo : 100}} ...</span> <span data-ng-if="item.url.length <= 100">{{item.url}}</span></td><td class="col-xs-3"><a data-ng-if="item.body" data-ng-click="item.showBody = !item.showBody">näytä / piilota</a><pre data-ng-show="item.showBody" data-ng-if="item.body">{{item.body | json}}</pre></td><td class="col-xs-1">{{item.user.username || \'Ei käyttäjää\'}}</td><td class="col-xs-1">{{item.user.lastName}} {{item.user.firstName}}</td><td class="col-xs-2">{{item.user.admin ? \'Pääkäyttäjä\':\'Normaalikäyttäjä\'}}</td></tr><tr data-ng-if="items.length === 0"><td colspan="100%" class="text-center text-muted"><em>Ei taustakyselyjä</em></td></tr></tbody></table><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/user/add-info.html",'<p>Tällä sivulla voit tehdä uuden käyttäjän sovellukseen.</p><p>Syötä uuden käyttäjän tiedot. Salasanan tulee olla vähintään 8 merkkiä pitkä. Käyttäjänimen ja salasanan tulee olla yksilöllinen.</p><p>Jos tunnus on liitetty alueomistajaan, käyttäjä voi muuttaa ainoastaan oletusomistajalla (Aluepöytä) ja itsellään olevia alueita. Alueomistajaan liittyvä tunnus ei voi olla pääkäyttäjä.</p><p>Voit antaa käyttäjälle lisäoikeuksia rastittamalla "Voi ..." -alkuiset oikeudet.</p><p>Väärin luotua tunnusta ei voi poistaa, se voidaan vain arkistoida.</p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/user/add.html",'<form class="form-vertical" role="form" name="userForm" data-ng-submit="addUser()"><div class="row"><div class="col-md-12"><div class="form-group" style="margin-top: 10px">Etunimi: <input class="form-control" name="user.firstName" required placeholder="Anna käyttäjän etunimi" data-ng-model="user.firstName"></div><div class="form-group" style="margin-top: 10px">Sukunimi: <input class="form-control" name="user.lastName" required placeholder="Anna käyttäjän sukunimi" data-ng-model="user.lastName"></div><div class="form-group" style="margin-top: 10px">Käyttäjänimi: <input class="form-control" name="user.username" required placeholder="Anna käyttäjänimi jota käytetään kirjautumiseen" data-ng-model="user.username"></div><div class="form-group" style="margin-top: 10px">Salasana: <input class="form-control" name="user.password1" required placeholder="Käyttäjän salasana" minlength="8" data-ng-model="user.password1"></div><div class="form-group" style="margin-top: 10px">Salasana uudelleen: <input class="form-control" name="user.password2" required placeholder="Käyttäjän salasana uudelleen" data-ng-model="user.password2"></div><div class="form-group" style="margin-top: 10px">Sähköpostiosoite: <input class="form-control" name="user.email" required placeholder="Käyttäjän sähköpostiosoite" data-ng-model="user.email"></div><div class="checkbox"><label><input type="checkbox" name="user.canAddAttributes" data-ng-model="user.canAddAttributes"> Voi lisätä alueille attribuutteja</label></div><div class="checkbox"><label><input type="checkbox" name="user.canAddAttributes" data-ng-model="user.canAddApartmentCount"> Voi muokata alueiden asuntojen lukumääriä</label></div><div class="checkbox"><label><input type="checkbox" name="user.canAddSpecialAddresses" data-ng-model="user.canAddSpecialAddresses"> Voi muokata alueiden kieltopaikkojen ja vieraskielisten osoitteiden tietoja</label></div><div class="form-group">Tunnukseen liitetty alueomistaja (jos valittu, rajoittaa toiminnot vain tälle omistajalle):<select class="form-control" data-ng-model="selectedHolderId" data-ng-options="holder.id as holder.name for holder in holders" data-ng-change="user.admin = false"><option value="">-- tunnus ei liity alueomistajaan --</option></select></div><div class="checkbox"><label><input data-ng-disabled="selectedHolderId" type="checkbox" name="user.admin" data-ng-model="user.admin"> Pääkäyttäjä</label></div><button type="submit" class="btn btn-primary" data-ng-disabled="!userForm.$valid && user.password1 != user.password2">Lisää uusi käyttäjä</button></div></div></form>');
}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/user/index-info.html","<p>Tällä sivulla näet sovellukseen luodut käyttäjät.</p><p>Voit tehdä uuden käyttäjän plus-symbolista oikealla ylhäällä.</p><p>Arkistoidut käyttäjät on merkitty yliviivauksella.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/user/index.html",'<h3>Käyttäjät ({{items.length}})<div class="pull-right"><a data-ui-sref="admin.user.add" data-tooltip="Uusi käyttäjä"><i class="fa fa-plus-circle"></i></a></div></h3><div class="row"><div class="col-sm-12 list-search"><list-search data-filters="filters" data-options="itemsPerPageOptions" data-items="itemsPerPage"></list-search></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div><table class="table table-hover"><thead class="noSelect"><tr><th class="text-nowrap {{item.class}}" data-ng-repeat="item in titleItems"><a data-ng-show="item.column" data-ng-click="changeSort(item)" data-ng-bind-html="item.title"></a> <span data-ng-show="!item.column" data-ng-bind-html="item.title"></span> <i class="fa" data-ng-show="sort.column == item.column" data-ng-class="{\'fa-angle-down\': !sort.direction, \'fa-angle-up\': sort.direction}"></i></th></tr></thead><tbody><tr data-ng-repeat="item in items"><td class="col-xs-2">{{item.firstName}}</td><td class="col-xs-2">{{item.lastName}}</td><td class="col-xs-1"><a data-ui-sref="admin.user.single({id: item.id})"><span style="{{item.archived ? \'text-decoration: line-through\':\'\'}}">{{item.username}}</span></a></td><td class="col-xs-2">{{item.email}}</td><td class="col-xs-2">{{item.admin ? \'admin\':\'regular user\'}} <span data-ng-if="item.archived">(archived)</span></td><td class="col-xs-3">{{item.createdAt | date : \'dd.MM.yyyy\'}}, <span data-am-time-ago="item.createdAt"></span></td></tr><tr data-ng-if="items.length === 0"><td colspan="100%" class="text-center text-muted"><em>Ei käyttäjiä</em></td></tr></tbody></table><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/user/user-info.html",'<p>Tällä sivulla voit muuttaa käyttäjän tietoja. Pääset muokkaustilaan painamalla työkalu-kuvaketta.</p><p>Käyttäjän sähköpostiosoite tulee olla yksilöllinen.</p><p>Jos tunnus on liitetty alueomistajaan, käyttäjä voi muuttaa ainoastaan oletusomistajalla (Aluepöytä) ja itsellään olevia alueita. Alueomistajaan liittyvä tunnus ei voi olla pääkäyttäjä. Voit poistaa linkityksen alueomistajaan valitsemalla linkitetyksi omistajaksi oletusomistajan (Aluepöytä).</p><p>Voit antaa käyttäjälle lisäoikeuksia rastittamalla "Voi ..." -alkuiset oikeudet. Rastien poistaminen poistaa oikeudet.</p><p>Väärin luotua tunnusta ei voi poistaa, se voidaan vain arkistoida. Arkistoitu käyttäjä ei voi kirjautua sovellukseen.</p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/admin/user/user.html",'<div data-ng-show="!user"><h3>Käyttäjää ei lötynyt</h3></div><div data-ng-show="user"><form class="form-vertical" role="form" data-editable-form name="editableForm" data-onaftersave="saveUser()"><div class="row"><div class="col-sm-4"><h3><span style="width: 100%" data-editable-text="user.firstName" data-e-name="user.firstName" data-e-required>{{user.firstName}}</span> <span style="width: 100%" data-editable-text="user.lastName" data-e-name="user.lastName" data-e-required>{{user.lastName}}</span> <span class="pull-right" data-ng-show="!editableForm.$visible && currentUser.admin"><a href="#" data-ng-click="editableForm.$show()" data-tooltip="Muokkaa"><i class="fa fa-wrench"></i></a></span></h3><dl><dt>Sähköpostiosoite</dt><dd><span style="width: 100%" data-editable-text="user.email" data-e-name="user.email" data-e-required>{{user.email}}</span></dd><dt>{{\'HOLDER\' | translate}}</dt><dd><span data-editable-select="user.holder.id" data-e-name="holder.id" data-e-ng-options="holder.id as holder.name for holder in holders | filter : onlyActiveHolders" data-e-required>{{user.holder.name || \'Käyttäjä ei liity alueomistajaan\'}}</span></dd><dt>Voi lisätä attribuutteja alueille</dt><dd><span data-editable-checkbox="user.canAddAttributes" data-e-title="Käyttäjä voi lisätä attribuutteja alueille">{{user.canAddAttributes ? \'Kyllä\' : \'Ei\'}}</span></dd><dt>Voi lisätä ja muuttaa alueen asuntojen määrää</dt><dd><span data-editable-checkbox="user.canAddApartmentCount" data-e-title="Käyttäjä voi muuttaa alueen asuntojen lukumäärän">{{user.canAddApartmentCount ? \'Kyllä\' : \'Ei\'}}</span></dd><dt>Voi lisätä ja muuttaa alueen kieltopaikkoja ja vieraskielisiä osoitteita</dt><dd><span data-editable-checkbox="user.canAddSpecialAddresses" data-e-title="Käyttäjä voi muuttaa alueen kieltopaikkojen ja vieraskielisten paikkojen osoitteita">{{user.canAddSpecialAddresses ? \'Kyllä\' : \'Ei\'}}</span></dd><dt>Arkistoitu</dt><dd><span data-editable-checkbox="user.archived" data-e-title="Käyttäjä ei ole enää käytössä">{{user.archived ? \'Kyllä\' : \'Ei\'}}</span></dd><dl><div><div data-ng-show="editableForm.$visible"><button type="submit" class="btn btn-primary" data-ng-disabled="editableForm.$waiting">Tallenna</button> <button type="button" class="btn btn-default" data-ng-disabled="editableForm.$waiting" data-ng-click="editableForm.$cancel()">Peruuta</button></div></div></dl></dl></div></div></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/about/about.html",'<h3>{{name || \'Aluehallintasovellus v2.0\'}}</h3><div class="row"><div class="col-sm-12"><p>Tämä aluehallintasovellus on tarkoitettu helpottamaan alueveljien työtä ja tarjoamaan ajantasaista tietoa seurakunnan aluetilanteesta.</p><h4>Tärkeimmät ominaisuudet</h4><ul><li>Alueiden merkitseminen eri omistajille ja käydyksi</li><li>Sopivien alueiden etsiminen eri attribuuttien mukaisesti</li><li>Käyttäjäoikeustasot, joiden avulla eri käyttäjien toimia voidaan hallita</li><li>Sähköpostimuistutukset alueiden käymisestä</li><li>Seurakunnan alueiden esittäminen havainnollisena karttana</li><li>S-13 -lomake</li></ul><h4>Suunnitteilla olevia ominaisuuksia</h4><ul><li>Alueiden antaminen julistajille linkkinä, sähköpostilla tai PDF-tiedostona</li></ul></div></div><h4 data-ng-show="!auth.isAuthenticated()">Jos sinulla on käyttäjätunnus, <a data-ui-sref="auth.login">kirjaudu sisään</a>.</h4><h4 data-ng-show="auth.isAuthenticated()">Olet kirjautunut sisään. Jatka <a data-ui-sref="app.territory">aluehallintaan</a>.</h4>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/app/app-info.html","<p>Aluehallinnan asetukset vaikuttavat koko sovelluksen toimintaan.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/app/app.html",'<div data-ng-show="!app"><h3>Sovellusasetuksia ei löytynyt! Ota yhteyttä ylläpitäjään.</h3></div><div data-ng-show="app"><form class="form-vertical" role="form" data-editable-form name="editableForm" data-onaftersave="saveApp()"><div class="row"><div class="col-sm-8"><h3><span style="width: 100%" data-editable-text="app.name" data-e-name="app.name" data-e-required>{{app.name || \'Sovellukselle ei ole annettu nimeä\'}}</span> <span class="pull-right" data-ng-show="!editableForm.$visible && user.admin"><a href="#" data-ng-click="editableForm.$show()" data-tooltip="Muuta asetuksia"><i class="fa fa-wrench"></i></a></span></h3><dl><dt>Alueiden oletusomistaja (yleensä aluepöytä tms.)</dt><dd><span data-editable-select="app.defaultHolder.id" data-e-name="defaultHolder.id" data-e-ng-options="holder.id as holder.name for holder in holders" data-e-required>{{app.defaultHolder.name || \'Ei asetettu\'}}</span></dd><dt>Sähköpostiosoite varmuuskopioiden vastaanottamiseen</dt><dd><span style="width: 100%" data-editable-text="app.backupEmail" data-e-name="app.backupEmail" data-e-required>{{app.backupEmail || \'Sähköpostiosoite puuttuu\'}}</span></dd><dt>Varmuuskopioiden väli (päiviä)</dt><dd><span style="width: 100%" data-editable-number="app.backupInterval" data-e-min="1" data-e-name="app.backupInterval" data-e-required>{{app.backupInterval || \'Ei asetettu\'}}</span></dd><dt>Aika, jonka jälkeen aluetta pidetään harvoin käytynä (päiviä)</dt><dd><span style="width: 100%" data-editable-number="app.notCoveredLimit" data-e-min="1" data-e-name="app.notCoveredLimit" data-e-required>{{app.notCoveredLimit || \'Ei asetettu\'}}</span></dd><dt>Aika, jonka jälkeen lähetetään muistutusviesti alueen käymisestä (päiviä)</dt><dd><span style="width: 100%" data-editable-number="app.notCoveredWarningEmailLimit" data-e-min="1" data-e-name="app.notCoveredWarningEmailLimit" data-e-required>{{app.notCoveredWarningEmailLimit || \'Ei asetettu\'}}</span></dd><dt>Aika, jonka jälkeen alue on ollut liian kauan samalla omistajalla (päiviä)</dt><dd><span style="width: 100%" data-editable-number="app.holderNotChangedWarningLimit" data-e-min="1" data-e-name="app.holderNotChangedWarningLimit" data-e-required>{{app.holderNotChangedWarningLimit || \'Ei asetettu\'}}</span></dd><dt>Oletus leveyskoordinaatti (Suomessa noin 60-64)</dt><dd><span style="width: 100%" data-editable-number="app.defaultLatitude" data-e-min="-90" data-e-max="90" data-e-step="any" data-e-name="app.defaultLatitude" data-e-required>{{app.defaultLatitude || \'Ei asetettu\'}}</span></dd><dt>Oletus pituuskoordinaatti (Suomessa noin 19-25)</dt><dd><span style="width: 100%" data-editable-number="app.defaultLongitude" data-e-min="-180" data-e-max="180" data-e-step="any" data-e-name="app.defaultLongitude" data-e-required>{{app.defaultLongitude || \'Ei asetettu\'}}</span></dd><dt>Tulostettavan aluekartan tyyppi</dt><dd><span data-editable-select="app.printMapType" data-e-name="app.printMapType" data-e-ng-options="type as type for type in mapTypes" data-e-required>{{app.printMapType || \'Ei asetettu\'}}</span></dd><dt>Tulostettavan aluekartan rajan väri</dt><dd><span style="width: 100%" data-editable-text="app.printMapLineColor" data-e-name="app.printMapLineColor" data-e-required>{{app.printMapLineColor || \'Asetus puuttuu\'}}</span></dd><dt>Tulostettavan aluekartan alueen väri</dt><dd><span style="width: 100%" data-editable-text="app.printMapAreaFillColor" data-e-name="app.printMapAreaFillColor" data-e-required>{{app.printMapAreaFillColor || \'Asetus puuttuu\'}}</span></dd><dt>Tulostettavan aluekartan skaalaus</dt><dd><span style="width: 100%" data-editable-number="app.printMapScale" data-e-min="0" data-e-max="2" data-e-step="1" data-e-name="app.printMapScale" data-e-required>{{app.printMapScale || \'Asetus puuttuu\'}}</span></dd><dt>Sähköposteissa toimivat avainkentät</dt><dd><pre>\n"_holderName" = alueomistajan nimi\n"_territoryCode" = alueen koodi\n"_territoryLat", = alueen leveyskoordinaatti\n"_territoryLng", = alueen pituuskoordinaatti\n"_taken", = aika jolloin alue on otettu\n"_covered" = aika jolloin alue on merkitty käydyksi\n"_territoryDetails", = alueen tarkempi kuvaus\n"_listAllTerritoryCodes" = kaikki alueomistajan alueiden koodit\n"_staticMap" = alueen karttakuva (jos rajat piirretty)\n"_staticMapSatellite" = alueen satelliittikuva (jos rajat piirretty)\n</pre></dd><dt>Sähköpostipohja: muistutus alueen käymisestä, viestin aihe</dt><dd><span style="width: 100%" data-editable-text="app.notificationEmailNotCoveredTerritoryTitle" data-e-name="app.notificationEmailNotCoveredTerritoryTitle" data-e-required>{{app.notificationEmailNotCoveredTerritoryTitle || \'Ei asetettu\'}}</span></dd><dt>Sähköpostipohja: muistutus alueen käymisestä</dt><dd><span style="width: 100%" data-editable-textarea="app.notificationEmailNotCoveredTerritory" data-e-name="app.notificationEmailNotCoveredTerritory" data-e-required>{{app.notificationEmailNotCoveredTerritory || \'Ei asetettu\'}}</span></dd><dt>Sähköpostipohja: uuden alueen ottaminen, viestin aihe</dt><dd><span style="width: 100%" data-editable-text="app.notificationEmailNewTerritoryTitle" data-e-name="app.notificationEmailNewTerritoryTitle" data-e-required>{{app.notificationEmailNewTerritoryTitle || \'Ei asetettu\'}}</span></dd><dt>Sähköpostipohja: uuden alueen ottaminen</dt><dd><span style="width: 100%" data-editable-textarea="app.notificationEmailNewTerritory" data-e-name="app.notificationEmailNewTerritory" data-e-required>{{app.notificationEmailNewTerritory || \'Ei asetettu\'}}</span></dd><dt>Sähköpostipohja: alueen palautus aluepöytään, viestin aihe</dt><dd><span style="width: 100%" data-editable-text="app.notificationEmailRemovedTerritoryTitle" data-e-name="app.notificationEmailRemovedTerritoryTitle" data-e-required>{{app.notificationEmailRemovedTerritoryTitle || \'Ei asetettu\'}}</span></dd><dt>Sähköpostipohja: alueen palautus aluepöytään</dt><dd><span style="width: 100%" data-editable-textarea="app.notificationEmailRemovedTerritory" data-e-name="app.notificationEmailRemovedTerritory" data-e-required>{{app.notificationEmailRemovedTerritory || \'Ei asetettu\'}}</span></dd><dt>Lähtevän sähköpostin osoite</dt><dd><span style="width: 100%" data-editable-email="app.notificationEmailSenderAddress" data-e-name="app.notificationEmailSenderAddress" data-e-required>{{app.notificationEmailSenderAddress || \'Ei asetettu\'}}</span></dd><dt>SMTP käyttäjänimi</dt><dd><span style="width: 100%" data-editable-text="app.smtpUsername" data-e-name="app.smtpUsername" data-e-required>{{app.smtpUsername || \'Ei asetettu\'}}</span></dd><dt>SMTP salasana</dt><dd><span style="width: 100%" data-editable-text="app.smtpPassword" data-e-name="app.smtpPassword" data-e-required>{{app.smtpPassword || \'Ei asetettu\'}}</span></dd><dl><div><div data-ng-show="editableForm.$visible"><button type="submit" class="btn btn-primary" data-ng-disabled="editableForm.$waiting">Tallenna</button> <button type="button" class="btn btn-default" data-ng-disabled="editableForm.$waiting" data-ng-click="editableForm.$cancel()">Peruuta</button></div></div></dl></dl></div></div></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/attributes/attributes-info.html",'<h4>Attribuutit</h4><p>Attribuutit ovat alueisiin liittyviä lisätietoja. Voit etsiä sopivia kuvakkeita <a href="https://fortawesome.github.io/Font-Awesome/icons/" target="_blank">Font Awesome -kirjastosta</a>. Kirjoita kuvakkeen nimi ilman fa-etuliitettä.</p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/attributes/attributes.html",'<div data-ng-show="!attributes.length"><h3>Attributes not found</h3></div><div data-ng-show="attributes.length"><table class="table table-condensed table-hover"><thead><tr><th>Nimi</th><th>Kuvaus</th><th>Kuvakkeen nimi</th><th>Kuvake</th><th></th></tr></thead><tbody data-ng-repeat="a in attributes"><tr><td><span data-editable-text="a.name" data-e-name="a.name" data-e-required data-onaftersave="updateAttribute(a)">{{a.name}}</span></td><td><span data-editable-text="a.description" data-e-name="a.description" data-e-required data-onaftersave="updateAttribute(a)">{{a.description}}</span></td><td><span data-editable-text="a.icon" data-e-name="a.icon" data-e-required data-onaftersave="updateAttribute(a)">{{a.icon}}</span></td><td><span class="fa fa-{{a.icon}}"></span></td><td><a data-ng-click="deleteAttribute(a)" data-ng-if="user.admin"><span title="Remove attribute" class="fa fa-trash"></span></a></td></tr></tbody></table></div><div data-ng-if="user.admin"><h3>Lisää uusi attribuutti</h3><form class="form-verical col-md-4" name="newAttributeForm" data-ng-submit="createAttribute(newAttribute)"><div class="form-group"><label for="name">Nimi</label><input data-ng-model="newAttribute.name" required class="form-control" id="name" placeholder="Esim. Hissi"></div><div class="form-group"><label for="description">Kuvaus</label><input data-ng-model="newAttribute.description" max-length="100" required class="form-control" id="description" placeholder="Esim. Talossa on hissi"></div><div class="form-group"><label for="icon">Kuvakkeen nimi</label><input data-ng-model="newAttribute.icon" required class="form-control" id="icon" placeholder="Font Awesome kuvake, esim. arrows-v"></div><input type="submit" id="submit" value="Lisää" class="btn btn-primary"></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/chat/chat-info.html",'<h4>General info</h4><p>This example demonstrates how to use sails.js and web sockets to pass updates between clients automatically. This simple <em>chat</em> application is perfect for this demonstration. All communications here are made via web sockets.</p><h4>Functions in this example</h4><dl class="dl-horizontal"><dt>Basic stuff</dt><dd>Enter / leave chat. Create new chat message. Message updates to all clients.</dd></dl><page-info-files data-files="{{files}}"></page-info-files>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/chat/chat.html",'<div class="chat-enter" data-ng-show="!message.nick"><h4>Enter a nick</h4><div class="input-group col-md-4"><input id="nick" name="nick" class="form-control" placeholder="Enter a nickname" data-ng-model="nick" data-ui-keypress="{\'enter\': \'enterToChat($event)\'}"> <span class="input-group-btn"><button class="btn btn-primary" type="button" data-ng-click="enterToChat()">Enter to chat</button></span></div></div><div class="chat" data-ng-show="message.nick"><div class="row"><div id="messages" class="col-md-12 messages chat-screen"><ul class="list-unstyled"><li class="clearfix" data-ng-repeat="message in messages | orderBy: \'createdAt\'"><span class="pull-left time text-muted"><code>[{{message.createdAt | amDateFormat:\'YYYY-MM-DD HH:mm:ss\'}}]</code></span> <span class="pull-left message"><span class="text-info">{{message.nick}}</span> <span data-ng-bind-html="message.message | linky : \'_blank\'"></span></span></li></ul></div></div><div class="row"><div class="col-md-12 input-group"><div class="input-group-addon">{{message.nick}}</div><input id="message" name="message" class="form-control" placeholder="enter chat message" data-ng-model="message.message" data-ui-keypress="{\'enter\': \'postMessage($event)\'}"><div class="input-group-btn"><button class="btn btn-primary" type="button" data-ng-click="postMessage()">Send message</button> <button class="btn btn-danger" type="button" data-tooltip="Leave chat" data-ng-click="leaveChat()"><i class="fa fa-times"></i></button></div></div></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/messages/messages-info.html",'<h4>General info</h4><p>This is an example page to demonstrate how this boilerplate handles errors with <em>$http</em> and <em>$sailsSocket</em> requests. Note that this <em>magic</em> is done automatically via the error interceptor so you don\'t have to do anything extra for error handling. The error handling is done via the error interceptor that is attached to <em>$http</em> and <em>$sailsSocket</em> services.</p><p>This interceptor will catch <em>all</em> errors from <em>$http</em> and <em>$sailsSocket</em> requests and show those to the user via the message service. Note that the message shown depends on the actual error response from the backend.</p><h4>Functions in this example</h4><dl class="dl-horizontal"><dt>Custom messages</dt><dd>Simple example to trigger different types of messages: <em>info, success, warning</em> and <em>error</em> with specified <em>title</em> and actual <em>message</em>.</dd><dt>$http / $sailsSocket</dt><dd>Examples to demonstrate invalid URL and not found record. These are handled automatically by <em>ErrorInterceptor</em>.</dd></dl><page-info-files data-files="{{files}}"></page-info-files>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/messages/messages.html",'<h3>Messages</h3><p>This page demonstrates how you can use the <code>Message</code> service in your application. This service is automatically hooked to <code>$http</code> and <code>$sailsSocket</code> errors.</p><div class="row"><div class="col-md-4"><h5 class="col-md-offset-3">Message trigger from form data</h5><form name="customMessage" class="form-horizontal" role="form"><div class="form-group"><label for="title" class="col-md-3 control-label">Title</label><div class="col-md-9"><input id="title" name="title" class="form-control" placeholder="Enter title" required data-ng-model="title"></div></div><div class="form-group"><label for="message" class="col-md-3 control-label">Message</label><div class="col-md-9"><textarea id="message" name="message" class="form-control" data-ng-model="message"></textarea></div></div><div class="form-group"><label for="type" class="col-md-3 control-label">Type</label><div class="col-md-9"><select id="type" name="type" class="form-control" required data-ng-model="type" data-ng-options="messageType as messageType for messageType in messageTypes"></select></div></div><div class="form-group"><div class="col-md-9 col-md-offset-3"><button class="btn btn-primary" data-ng-disabled="!customMessage.$valid" data-ng-click="showMessage()">Show message</button></div></div></form></div><div class="col-md-4"><h5>Automatic message trigger via <code>$http</code></h5><div class="form-group"><button class="btn btn-primary" data-ng-click="makeInvalidHttpRequest(0)">Invalid URL</button> <button class="btn btn-primary" data-ng-click="makeInvalidHttpRequest(1)">Record not found</button></div><h5>Automatic message trigger via <code>$sailsSocket</code></h5><div class="form-group"><button class="btn btn-primary" data-ng-click="makeInvalidSailsSocketRequest(0)">Invalid URL</button> <button class="btn btn-primary" data-ng-click="makeInvalidSailsSocketRequest(1)">Record not found</button></div></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/holder/add-info.html","<h4>Alueomistajan lisääminen</h4><p>Kirjoita tarvittavat tiedot ja paina tallenna.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/holder/add.html",'<form class="form-vertical" role="form" name="holderForm" data-ng-submit="addHolder()"><div class="row"><div class="col-lg-8"><div class="form-group" style="margin-top: 10px"><input class="form-control" required name="name" placeholder="{{\'HOLDER_NAME\' | translate}}" data-ng-model="holder.name"></div><div class="form-group"><input type="email" class="form-control" required name="email" placeholder="{{\'HOLDER_EMAIL\' | translate}}" data-ng-model="holder.email"></div><div class="form-group"><input class="form-control" name="telephone" placeholder="{{\'HOLDER_TELEPHONE\' | translate}}" data-ng-model="holder.telephone"></div><div class="form-group"><input class="form-control" name="description" placeholder="{{\'HOLDER_DESCRIPTION\' | translate}}" data-ng-model="holder.description"></div><div class="checkbox"><label><input type="checkbox" name="emailValid" data-ng-model="holder.emailValid"> {{\'EMAIL_ADDRESS_IS_IN_USE\' | translate}}</label></div><div><button type="submit" class="btn btn-primary" data-ng-disabled="!holderForm.$valid">{{\'SAVE\' | translate}}</button></div></div></div></form>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/holder/holder-info.html","<h4>Alueomistajan tiedot</h4><p>Tällä sivulla näet alueomistajan tiedot ja hänen hallussaan olevat alueet.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/holder/holder.html",'<div data-ng-show="!holder"><h3>{{\'HOLDER_NOT_FOUND\' | translate}}</h3></div><div data-ng-show="holder"><form class="form-vertical" role="form" data-editable-form name="editableForm" data-onaftersave="saveHolder()"><div class="row"><div class="col-md-4"><h3><span style="width: 100%" data-editable-text="holder.name" data-e-name="holder.name" data-e-required>{{holder.name}} <span data-ng-if="holder.isArchived">(arkistoitu)</span></span> <span class="pull-right" data-ng-show="!editableForm.$visible && user.admin"><a href="#" data-ng-click="editableForm.$show()" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h3><dl class="dl-horizontal"><dt>{{\'EMAIL\' | translate}}</dt><dd><span style="width: 100%" data-editable-text="holder.email" data-e-name="holder.email" data-e-required>{{holder.email}}</span></dd><dt>{{\'HOLDER_EMAIL_IN_USE\' | translate}}</dt><dd><span data-editable-checkbox="holder.emailValid" data-e-title="{{\'HOLDER_EMAIL_IN_USE\' | translate}}">{{holder.emailValid ? \'Kyllä\' : \'Ei\'}}</span></dd><dt>{{\'HOLDER_TELEPHONE\' | translate}}</dt><dd><span style="width: 100%" data-editable-text="holder.telephone" data-e-name="holder.telephone">{{holder.telephone}}</span></dd><dd><dt>{{\'HOLDER_DESCRIPTION\' | translate}}</dt></dd><dd><p data-editable-textarea="holder.description" data-e-name="holder.description">{{holder.description}}</p></dd><dt>{{\'ARCHIVED\' | translate}}</dt><dd><span data-editable-checkbox="holder.isArchived" data-e-title="Alueomistaja ei ole käytössä">{{holder.isArchived ? \'Kyllä\' : \'Ei\'}}</span></dd><dl><div><div data-ng-show="editableForm.$visible"><button type="submit" class="btn btn-primary" data-ng-disabled="editableForm.$waiting">{{\'SAVE\' | translate}}</button> <button type="button" class="btn btn-default" data-ng-disabled="editableForm.$waiting" data-ng-click="editableForm.$cancel()">{{\'CANCEL\' | translate}}</button> <button type="button" class="btn btn-danger pull-right" data-ng-bootbox-title="Olet poistamassa alueomistajaa" data-ng-bootbox-custom-dialog="Oletko varma, että haluat poistaa <strong>{{holder.name}}</strong> nimisen alueomistajan?" data-ng-bootbox-buttons="confirmButtonsDelete">{{\'DELETE\' | translate}}</button></div></div></dl></dl></div><div class="col-md-8"><h4 class="text-muted top-buffer">{{holder.territories.length ? \'Alueomistajan alueet\' : \'Alueomistajalla ei ole yhtään aluetta\'}}</h4><table data-ng-if="holder.territories.length" class="table table-condensed table-hover"><thead><tr><th class="col-xs-2">{{\'TERRITORY\' | translate}}</th><th class="col-xs-2 text-nowrap">{{\'COVERED\' | translate}}</th><th class="col-xs-2 text-nowrap">{{\'TAKEN\' | translate}}</th><th class="col-xs-6 text-nowrap">{{\'DESCRIPTION\' | translate}}</th></tr></thead><tbody data-ng-repeat="t in holder.territories"><tr><td><a data-ui-sref="app.territory.single({id: t.id})"><strong>{{t.territoryCode}}</strong></a></td><td data-ng-class="isNotCoveredLimitExeeded(t, app) ? \'bg-danger\' : \'\'"><a data-tooltip="{{t.covered | amTimeAgo}}">{{t.covered | date : \'dd.MM.yyyy\'}}</a></td><td data-ng-class="isHolderNotChangedLimitExeeded(t, app) ? \'bg-danger\': \'\'"><a data-tooltip="{{t.taken | amTimeAgo}}">{{t.taken | date : \'dd.MM.yyyy\'}}</a></td><td><a data-tooltip="{{t.description}}">{{t.description | limitTo : 50}} {{t.description.length > 50 ? \'...\' : \'\'}}</a></td></tr></tbody></table></div></div></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/holder/list-info.html","<h4>Alueomistajat</h4><p>Tämä näkymä listaa kaikki alueomistajat. Hakutoiminnon avulla voit etsiä alueomistajia. Voit valita alueomistajan painamalla omistajan nimeä ja nähdä tarkempia tietoja.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/holder/list.html",'<h3>Alueomistajat ({{itemCount}}) <a class="pull-right" data-ng-if="user.admin" data-ui-sref="app.holder.add" data-tooltip="Lisää uusi alueomistaja"><i class="fa fa-plus-circle"></i></a></h3><div class="row"><div class="col-sm-12 list-search"><list-search data-filters="filters" data-options="itemsPerPageOptions" data-items="itemsPerPage"></list-search></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div><div class="row"><div class="col-sm-12"><table class="table table-hover"><thead class="noSelect"><tr><th class="text-nowrap {{item.class}}" data-ng-repeat="item in titleItems"><a data-ng-show="item.column" data-ng-click="changeSort(item)" data-ng-bind-html="item.title"></a> <span data-ng-show="!item.column" data-ng-bind-html="item.title"></span> <i class="fa" data-ng-show="sort.column == item.column" data-ng-class="{\'fa-angle-down\': !sort.direction, \'fa-angle-up\': sort.direction}"></i></th></tr></thead><tbody><tr data-ng-repeat="holder in items"><td class="col-md-3"><a data-ui-sref="app.holder.single({id: holder.id})"><span data-ng-if="!holder.isArchived">{{holder.name}}</span> <span data-ng-if="holder.isArchived"><s>{{holder.name}}</s> (arkistoitu)</span></a></td><td class="col-md-3 mobile-hide">{{holder.email}}</td><td class="col-md-2 mobile-hide">{{holder.telephone}}</td><td class="col-md-3">{{holder.description}}</td><td class="col-md-1">{{holder.territories.length}}</td></tr><tr data-ng-if="items.length === 0"><td colspan="100%" class="text-center text-muted"><em>Ei omistajia ...</em></td></tr></tbody></table></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div>');
}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/add-info.html","<p>Tässä näkymässä voit lisätä uuden alueen.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/add.html",'<div class="modal-header"><button type="button" class="close" data-dismiss="modal" data-ng-click="dismiss()"><span aria-hidden="true">&times;</span> <span class="sr-only">Sulje</span></button><h3 class="modal-title">Uuden alueen lisääminen</h3></div><div class="modal-body modal-help"><form class="form-vertical" role="form" name="territoryForm" data-ng-submit="addTerritory()"><div class="row"><div class="col-md-12"><div class="form-group" style="margin-top: 10px">{{\'TERRITORY_CODE\' | translate}}: <input class="form-control" name="territory.territoryCode" required placeholder="Kirjoita alueen koodi tai tunnus" data-ng-model="territory.territoryCode"></div><div class="form-group" style="margin-top: 10px">{{\'TYPE\' | translate}}: <input class="form-control" name="territory.type" required placeholder="Kirjoita aluetyyppi" data-ng-model="territory.type"></div><div class="form-group" style="margin-top: 10px">{{\'NUMBER_OF_APARTMENTS\' | translate}}: <input type="number" min="0" class="form-control" name="territory.apartmentCount" required placeholder="Kirjoita alueen asuntojen lukumäärä kokonaislukuna" data-ng-model="territory.apartmentCount"></div><div class="form-group">{{\'DESCRIPTION\' | translate}}:<textarea name="territory.description" class="form-control" required placeholder="Kirjoita alueen kuvaus" data-ng-model="territory.description">{territory.description}</textarea></div><div class="form-group">{{\'COVERED\' | translate}}:<p class="input-group"><input required class="form-control" data-datepicker-popup="dd.MM.yyyy" data-is-open="coveredDatePickerIsOpen" data-ng-click="datePickerOpened($event); coveredDatePickerIsOpen = true;" data-ng-model="territory.covered"><span class="input-group-btn"><button type="button" class="btn btn-default" data-ng-click="datePickerOpened($event); coveredDatePickerIsOpen = true;"><span class="fa fa-calendar"></span></button></span></p></div><div class="form-group">{{\'TAKEN\' | translate}}:<p class="input-group"><input class="form-control" data-datepicker-popup="dd.MM.yyyy" required data-is-open="takenDatePickerIsOpen" data-ng-click="datePickerOpened($event); takenDatePickerIsOpen = true;" data-ng-model="territory.taken"><span class="input-group-btn"><button type="button" class="btn btn-default" data-ng-click="datePickerOpened($event); coveredDatePickerIsOpen = true;"><span class="fa fa-calendar"></span></button></span></p></div><div class="form-group">{{\'INITIAL_HOLDER\' | translate}}:<select class="form-control" data-ng-model="selectedHolder" required data-ng-options="holder.id as holder.name for holder in holders"></select></div><div class="form-group" style="margin-top: 10px">{{\'Leveyskoordinaatti\' | translate}}: <input type="number" min="-90" max="90" step="0.0000000000000001" class="form-control" name="map.territoryCenterMarker.coords.latitude" required placeholder="Anna leveyskoordinaatti" data-ng-model="map.territoryCenterMarker.coords.latitude"> {{\'Pituuskoordinaatti\' | translate}}: <input type="number" min="-180" max="180" step="0.0000000000000001" class="form-control" name="map.territoryCenterMarker.coords.longitude" required placeholder="Anna pituuskoordinaatti" data-ng-model="map.territoryCenterMarker.coords.longitude"></div><ui-gmap-google-map center="map.center" zoom="map.zoom"><ui-gmap-marker coords="map.territoryCenterMarker.coords" idkey="map.territoryCenterMarker.id" options="map.territoryCenterMarker.options" events="map.territoryCenterMarker.events"></ui-gmap-marker></ui-gmap-google-map><button type="submit" class="btn btn-primary" data-ng-disabled="!territoryForm.$valid">{{\'SAVE\' | translate}}</button></div></div></form></div><div class="modal-footer"><button class="btn btn-primary btn-sm" data-ng-click="dismiss()">Sulje</button></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/list-info.html",'<h4>Alueiden merkitseminen ja omistajan vaihtaminen</h4><ol><li>Valitse alueet joita haluat muuttaa rastittamalla alueet "Valinta"-sarakkeessa.</li><li>Ilmestyvässä ikkunassa näet valitut alueet.</li><li>Kun valinta on tehty, paina "Tee muutoksia alueisiin".</li><li>Valitse toiminto, jonka haluat tehdä.</li><li>Paina tallenna tai peruuta.</li></ol><p>Huom! Jos käyttäjätunnuksesi liittyy tiettyyn alueomistajaan, voit valita vain omia tai aluepöydässä olevia alueita.</p><h4>Alueiden haku</h4><ol><li>Kirjoita hakutermit niille varattuun tilaan.</li><li>Voit hakea myös tietyn omistajan alueita.</li><li>Kaikki hakuehdot yhdistetään TAI-operaattorilla.</li><li>Voit poistaa hakuehtoja yksitellen klikkaamalla niitä.</li></ol><h4>Sähköpostimuistutukset</h4>Muistutus lähetetään seuraavista tapahtumista:<ol><li>Alueen ottaminen.</li><li>Alueen palauttaminen.</li><li>Aluetta ei ole käyty määräaikaan mennessä.</li></ol>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/list.html",'<div data-territory-sub-pages></div><div class="alert alert-info top-buffer email-warning" data-ng-show="mailsTotal > 0"><h4><i class="fa fa-envelope"></i> Sähköpostimuistutukset <button type="button" class="close" data-dismiss="alert">&times;</button></h4><span data-ng-class="mailsTotal > 5 ? \'badge badge-important\' : \'badge badge-info\'">{{mailsTotal}}</span> <span data-ng-if="mailsTotal == 1">viesti odottaa lähettämistä.</span> <span data-ng-if="mailsTotal > 1">viestiä odottaa lähettämistä.</span> <a class="btn btn-xs btn-primary" data-ng-click="sendNotificationEmails()">Lähetä</a></div><div class="alert alert-danger top-buffer backup-warning" data-ng-show="suggestBackup"><h4><i class="fa fa-exclamation-circle"></i> Varmuuskopiointi <button type="button" class="close" data-dismiss="alert">&times;</button></h4>Edellisen varmuuskopion ottamisesta on kulunut jo tovi <a class="btn btn-xs btn-danger" data-ng-click="runBackup()">Varmuuskopioi</a></div><h3>{{\'TERRITORIES\' | translate}} ({{itemCount}}) <a class="pull-right" data-ng-if="user.admin" data-ui-sref="app.territory.add" data-tooltip="Lisää uusi alue"><i class="fa fa-plus-circle"></i></a></h3><div class="row"><div class="col-sm-12"><list-search data-holders="holders" data-attributes="attributes" data-filters="filters" data-options="itemsPerPageOptions" data-items="itemsPerPage"></list-search><ul class="list-inline" data-ng-if="filters.searchWord.length">Hakutermit:<li data-ng-repeat="w in filters.searchWord.split(\' \') track by $index"><span class="label label-primary" data-ng-click="removeSearchWord(filters.searchWord, $index);">{{w}} <span class="fa fa-times"></span></span></li></ul><span data-ng-if="filters.holderId">Ainoastaan omistaja: <span class="label label-primary" data-ng-click="filters.holderId = null;">{{getHolderNameWithId(holders, filters.holderId)}} <span class="fa fa-times"></span></span></span> <span data-ng-if="filters.attributeLinkId">&nbsp;Ainoastaan attribuutti: <span class="label label-primary" data-ng-click="filters.attributeLinkId = null;"><span class="fa fa-{{getAttributeWithId(attributes, filters.attributeLinkId).icon}}"></span> {{getAttributeWithId(attributes, filters.attributeLinkId).name}} <span class="fa fa-times"></span></span></span></div></div><div class="row"><div class="col-sm-12"></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager><table class="table table-hover"><thead class="noSelect"><tr><th class="text-nowrap {{item.class}}" data-ng-repeat="item in titleItems | filter:titleFilter"><a data-ng-show="item.column" data-ng-click="changeSort(item)" data-ng-bind-html="item.title"></a> <span data-ng-show="!item.column" data-ng-bind-html="item.title">{{item.title | translate}}</span> <i class="fa" data-ng-show="sort.column == item.column" data-ng-class="{\'fa-angle-down\': !sort.direction, \'fa-angle-up\': sort.direction}"></i></th></tr></thead><tbody data-ng-repeat="territory in items"><tr data-ng-class="territory.checked ? \'bg-info\' : (selectionDisabledFilter(territory) ? \'bg-tuned-down\' : \'\')"><td class="col-md-1 valign"><h4><strong><a data-ui-sref="app.territory.single({id: territory.id})"><span data-ng-if="!territory.archived">{{territory.territoryCode || territory.id}}</span> <span data-ng-if="territory.archived"><s>{{territory.territoryCode || territory.id}}</s></span></a></strong></h4></td><td class="col-md-1 valign mobile-hide">{{territory.type}} <span data-ng-if="territory.archived">(arkistoitu)</span></td><td data-ng-class="isNotCoveredLimitExeeded(territory, app) ? \'bg-danger col-md-1 valign\' : \'col-md-1 valign\'"><a data-tooltip="{{territory.covered | amTimeAgo}}">{{territory.covered | date : \'dd.MM.yyyy\'}}</a></td><td data-ng-class="isHolderNotChangedLimitExeeded(territory, app) ? \'bg-danger col-md-1 valign mobile-hide\': \'col-md-1 valign mobile-hide\'"><a data-tooltip="{{territory.taken | amTimeAgo}}">{{territory.taken | date : \'dd.MM.yyyy\'}}</a> <a data-ng-if="getLastTerritoryHolderHistory(territory).description" class="fa fa-comment" data-tooltip="{{getLastTerritoryHolderHistory(territory).description}}"></a></td><td class="col-md-1 valign mobile-hide"><ul class="list-inline"><li data-ng-repeat="tla in territory.territoryLinkAttribute"><span class="fa fa-{{getAttributeWithId(attributes, tla.attribute).icon}}" data-tooltip="{{getAttributeWithId(attributes, tla.attribute).description}}"></span></li><li data-ng-if="user.admin || user.canAddAttributes"><span data-editable-select="newAttributeLink" data-e-ng-options="a.id as a.name for a in attributes" data-onaftersave="addAttributeLink(territory, newAttributeLink)"><a class="fa fa-plus-circle" data-tooltip="Lisää uusi attribuutti"></a></span></li></ul></td><td class="col-md-4 valign mobile-hide"><span class="badge" data-ng-if="!user.admin && territory.apartmentCount"><span data-tooltip="{{territory.apartmentCount ? \'Asuntojen lukumäärä \' + territory.apartmentCount : \'Asuntojen lukumäärä ei ole tiedossa\'}}">{{territory.apartmentCount}}</span></span> <a data-tooltip="{{territory.description}}">{{territory.description | limitTo : 60}} {{territory.description.length > 60 ? \'...\' : \'\'}}</a> <span class="pull-right" data-ng-if="user.admin || user.canAddApartmentCount" data-editable-number="territory.apartmentCount" data-onaftersave="updateApartmentCount(territory, territory.apartmentCount)"><a data-tooltip="{{territory.apartmentCount ? \'Asuntojen lukumäärä \' : \'Asuntojen lukumäärä ei ole tiedossa\'}}">{{territory.apartmentCount || \'?\'}}</a></span></td><td data-ng-class="!isDefaultHolder(territory.holder.id) ? \'bg-tuned-down col-md-2 valign\' : \'col-md-2 valign\'"><a data-ui-sref="app.holder.single({id: territory.holder.id})">{{territory.holder.name}}</a></td><td class="col-md-1 valign text-center"><label class="whitespace-label"><input type="checkbox" class="big-checkbox" id="checkbox_{{territory.id}}" data-ng-model="territory.checked" data-ng-change="territoryChecked(territory, items)" data-ng-disabled="selectionDisabledFilter(territory)"></label></td></tr><tr data-ng-if="items.length === 0"><td colspan="100%" class="text-center text-muted"><em>no data found...</em></td></tr></tbody></table></div></div><div class="row"><div class="col-sm-12"><pagination class="pagination-sm pull-right mobile-hide" data-total-items="itemCount" data-ng-model="currentPage" data-items-per-page="itemsPerPage" data-max-size="5" data-boundary-links="true" data-rotate="false" data-first-text="{{\'FIRST\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}" data-next-text="{{\'NEXT\' | translate}}" data-last-text="{{\'LAST\' | translate}}"></pagination><pager class="desktop-hide" total-items="itemCount" data-ng-model="currentPage" data-rotate="false" data-items-per-page="itemsPerPage" data-next-text="{{\'NEXT\' | translate}}" data-previous-text="{{\'PREVIOUS\' | translate}}"></pager></div></div><div class="row top-buffer" data-ng-show="filteredItems.length > 0"><div class="col-sm-12"><div class="panel panel-primary" id="territoryOperationsWrapper"><div class="panel-heading"><button class="btn btn-xs btn-primary pull-right" data-ng-click="clearSelected(items)"><i style="color: white" class="fa fa-times text-info"></i></button> <button style="margin-right: 2px" class="btn btn-xs btn-primary pull-right" class="btn btn-primary btn-sm" data-ng-init="isAllCollapsed = false" data-ng-click="isAllCollapsed = !isAllCollapsed"><i data-ng-if="!isAllCollapsed" style="color: white" class="fa fa-minus text-info"></i> <i data-ng-if="isAllCollapsed" style="color: white" class="fa fa-square-o text-info"></i></button> {{\'OPERATIONS_FOR_SELECTED_TERRITORIES\' | translate}} ({{filteredItems.length}})<div class="clearfix"></div></div><div class="panel-body" id="territoryOperations" data-collapse="isAllCollapsed"><ul class="list-inline"><li class="vertical-list" data-ng-repeat="t in filteredItems = (items | filter : onlyCheckedTerritories)"><a data-ui-sref="app.territory.single({id: t.id})"><h3>{{t.territoryCode || t.id}}</h3></a></li></ul><span class="text-muted">Nykyinen omistaja {{getHolderNameWithId(holders, selectedTerritoryHolderId)}}</span><div data-collapse="isCollapsed"><form class="form-horizontal"><fieldset class="fieldset-nomargins"><legend>Alueiden merkitseminen ja omistajan vaihtaminen</legend><div class="form-group row"><label class="col-lg-12 control-label text-left" for="operation">Valitse toiminto</label><div class="col-lg-12"><div class="radio"><label for="operation-0"><input type="radio" data-ng-model="operation" name="operation" id="operation-0" value="1" checked data-ng-disabled="isDefaultHolder(selectedTerritoryHolderId)" data-ng-change="territoryOperationChange(operation)"> Merkitse käydyksi (alueomistaja ei vaihdu)</label></div><div class="radio"><label for="operation-1"><input type="radio" data-ng-model="operation" name="operation" id="operation-1" data-ng-disabled="isDefaultHolder(selectedTerritoryHolderId)" data-ng-change="territoryOperationChange(operation)" value="2"> Merkitse käydyksi ja vaihda alueomistaja</label></div><div class="radio"><label for="operation-2"><input type="radio" data-ng-model="operation" name="operation" id="operation-2" data-ng-change="territoryOperationChange(operation)" value="3"> Vaihda alueomistaja (ei merkitä käydyksi)</label></div></div></div><div class="form-group row" data-ng-show="operation == 2 || operation == 3"><label class="col-lg-12 control-label text-left" for="selectbasic">Uusi alueomistaja</label><div class="col-lg-12"><select id="selectbasic" class="form-control" data-ng-model="selectedHolder" data-ng-options="holder.id as ((holder.id == selectedTerritoryHolderId ? \'* \':\'\') + holder.name) for holder in holders | filter : onlyAllowedHolders | filter : onlyActiveHolders"></select></div></div><div class="form-group row"><label class="col-lg-12 control-label text-left" for="textinput">Kommentti</label><div class="col-lg-12"><input id="textinput" data-ng-model="territoryChangeComment" name="textinput" maxlength="100" placeholder="Muutokseen liittyvä kommentti" class="form-control input-md"> <span class="help-block">Voit kirjoittaa kommentin esim. jos alue on käyty kampanjan yhteydessä</span></div></div><div class="form-group top-buffer"><div class="col-lg-12"><button data-ng-if="operation !== \'1\' && operation !== \'2\' && operation !== \'3\'" class="btn btn-success btn-md" disabled>Tallenna</button> <button data-ng-if="operation === \'1\'" class="btn btn-success btn-md" data-ng-click="markTerritoriesAsCovered(filteredItems, territoryChangeComment)">Tallenna</button> <button data-ng-if="operation === \'2\'" class="btn btn-success btn-md" data-ng-disabled="!selectedHolder || selectedHolder === selectedTerritoryHolderId" data-ng-click="changeHolder(filteredItems, true, selectedHolder, territoryChangeComment)">Tallenna</button> <button data-ng-if="operation === \'3\'" class="btn btn-success btn-md" data-ng-disabled="!selectedHolder || selectedHolder === selectedTerritoryHolderId" data-ng-click="changeHolder(filteredItems, false, selectedHolder, territoryChangeComment)">Tallenna</button> <button class="btn btn-danger btn-md pull-right" data-ng-click="clearSelected(items)">Peruuta</button></div></div></fieldset></form></div></div><div class="panel-footer text-center" data-collapse="isAllCollapsed"><button class="btn btn-primary btn-xs" data-ng-init="isCollapsed = true" data-ng-click="isCollapsed = !isCollapsed">{{isCollapsed ? \'Tee muutoksia alueisiin\' : \'Pienennä\'}}</button><div class="clearfix"></div></div></div></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/map-info.html","<p>Tässä näkymässä voit tarkastella alueita kartalla.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/map.html",'<style>.angular-google-map-container { height: 800px; }</style><div data-territory-sub-pages></div><ui-gmap-google-map class="bigMap" center="map.center" zoom="map.zoom"><ui-gmap-window show="map.window.show" coords="map.window.model" options="map.window.options" closeclick="map.window.closeClick()"><div><h4><a href="/app/territory/{{map.window.linkId}}">{{map.window.title}}</a></h4><p>{{\'COVERED\' | translate}} <span data-am-time-ago="map.window.covered"></span></p></div></ui-gmap-window><ui-gmap-markers models="territoryMarkers" coords="\'self\'" icon="\'icon\'" fit="true" events="map.markersEvents" options="\'options\'"></ui-gmap-markers></ui-gmap-google-map>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/quickview-info.html","<p>Tässä näkymässä voit tarkastella alueiden tilannetta nopeasti.</p><ul><li>Lihavoidut koodit tarkoittavat alueita jotka ovat aluepöydässä.</li><li>Lihavoidut koodit tarkoittavat alueita jotka ovat jollakulla alueomistajista.</li><li>Punaiset koodit tarkoittavat alueita joita ei ole merkitty käydyksi määräaikaan mennessä.</li></ul>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/quickview.html",'<div data-territory-sub-pages></div><div class="content top-buffer"><ul class="list-inline"><li class="vertical-list" data-ng-repeat="t in territories | orderBy  : \'territoryCode\'"><h4><a data-ui-sref="app.territory.single({id: t.id})" data-ng-class="isDefaultHolder(t.holder.id) ? \'strong-text\':\'\'"><span data-tooltip="Omistaja {{t.holder.name}}. Käyty {{t.covered | amTimeAgo}}." data-ng-class="isNotCoveredRecently(t, app) ? \'text-danger\' : \'\'">{{t.territoryCode}}</span></a></h4></li></ul></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/s13-info.html","<p>S-13 lomake vastaa painettua lomaketta. Voit tulostaa lomakkeen normaalisti selaimen tulostustoiminnolla.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/s13.html",'<div data-territory-sub-pages></div><div data-ng-repeat="t in territories"><div data-ng-if="$index !== 0 && $index % 5 === 0" style="page-break-after: always"></div><h3 data-ng-if="$index === 0 || $index % 5 === 0" class="col-xs-12">{{\'TERRITORY_LIST\' | translate}}</h3><table border="1px" class="s13"><thead><tr><th colspan="2" width="124px" class="text-center">{{t.territoryCode}}</th></tr></thead><tbody data-ng-repeat="thh in t.territoryHolderHistory"><tr style="height: 21px"><td colspan="2">{{getHolderNameWithId(thh.holder)}}</td></tr><tr style="height: 21px"><td class="small">{{thh.startDate | date: \'dd.MM.yyyy\'}}</td><td class="small">{{thh.endDate | date: \'dd.MM.yyyy\'}}</td></tr></tbody><tbody data-ng-repeat="x in t.emptyArray"><tr style="height: 21px"><td colspan="2">&emsp;</td></tr><tr style="height: 21px"><td>&emsp;</td><td>&emsp;</td></tr></tbody></table></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/stats-info.html","<p>Tilastot kertovat alueiden tilanteen eri tunnuslukujen avulla.</p>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/stats.html","<div data-territory-sub-pages></div><div><table><tr><td>Alueita yhteensä</td><td>{{totalCount}}</td></tr><tr></tr><tr><td>Alueita aluepöydässä</td><td>{{holderIsDefault}}</td></tr><tr></tr><tr><td>Huonosti käytyjä alueita ({{app.notCoveredLimit}} päivää käymättä)</td><td>{{notCoveredRecently}}</td></tr><tr></tr><tr><td>Alueita, joita ei lasketa huonosti käydyiksi (esim. puhelin- ja liikealueet)</td><td>{{totalNotCountedWhenCalculatingCoveredDuringLastYearTotal}}, joista huonosti käytyjä {{totalNotCountedWhenCalculatingCoveredDuringLastYearTotalNotCovered}}</td></tr><tr></tr><tr><td>Keskimääräinen aika käydyksi merkitsemisen välillä</td><td>{{averageCoveredTime}}</td></tr><tr></tr><tr><td>Keskimääräinen aika samalla omistajalla</td><td>{{averageTimeSameHolder}}</td></tr><tr></tr></table></div>")}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/territory-info.html",'<p>Tässä näkymässä voit tarkastella alueen tietoja ja karttaa.</p><h4>Kieltopaikkojen ja vieraskielisten merkitseminen</h4><ol><li>Klikkaa työkalu-kuvaketta "Kieltopaikat ja vieraskieliset" -listan kohdalta.</li><li>Kirjoita paikan nimi, osoite ja valitse oikea tyyppi.</li><li>Lisää merkintä klikkaamalla "Lisää"</li></ol><p>Vain pääkäyttäjät voivat tehdä muutoksia alueen tietoihin lukuunottamatta kieltopaikkojen ja vieraskielisten merkitsemistä.</p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/app/territory/territory.html",'<div data-ng-show="!territory"><h3>{{\'TERRITORY_NOT_FOUND\' | translate}}</h3></div><div class="row print-only"><div class="col-sm-12 col-print-12"><h3>{{territory.territoryCode || \'Alueen koodi puuttuu\'}} <span class="pull-right">{{territory.type}}</span></h3><pre style="white-space: pre-line; width: 100%">\n            {{territory.description}}\n        </pre><p ng-show="!!territory.apartmentCount">Alueen asuntojen yhteismäärä {{territory.apartmentCount}}</p></div></div><div class="row"><div class="col-sm-6 no-print"><div data-ng-show="territory"><form class="form-vertical" role="form" data-editable-form name="editableForm" data-onaftersave="saveTerritory()"><h3><span style="width: 100%" data-editable-text="territory.territoryCode" data-e-name="territory.territoryCode" data-e-required>{{territory.territoryCode}} <span data-ng-if="territory.archived">(arkistoitu)</span></span> <span class="pull-right" data-ng-show="!editableForm.$visible && user.admin"><a href="#" class="no-print" data-ng-click="editableForm.$show()" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h3><dl class="dl-horizontal no-print"><dt>{{\'HOLDER\' | translate}}</dt><dd><span data-editable-select="territory.holder.id" data-e-name="holder.id" data-e-ng-options="holder.id as holder.name for holder in holders | filter : onlyActiveHolders" data-e-required><a data-ui-sref="app.holder.single({id: territory.holder.id})">{{territory.holder.name}}</a></span></dd><dt>{{\'COVERED\' | translate}}</dt><dd><span data-editable-bsdate="territory.covered" data-e-ng-click="openPickers(\'coveredDateOpened\')" data-e-is-open="pickers.coveredDateOpened" data-e-datepicker-popup="dd.MM.yyyy" data-e-current-text="Tänään" data-e-clear-text="Tyhjennä" data-e-close-text="Ok" data-e-name="date"><a data-ng-class="isNotCoveredLimitExeeded(territory, app) ? \'bg-danger\' : \'\'" data-tooltip="{{territory.covered | amTimeAgo}}">{{(territory.covered | date : \'dd.MM.yyyy\') || \'Ei merkintää\'}}</a></span></dd><dt>{{\'TAKEN\' | translate}}</dt><dd><span data-editable-bsdate="territory.taken" data-e-ng-click="openPickers(\'takenDateOpened\')" data-e-is-open="pickers.takenDateOpened" data-e-datepicker-popup="dd.MM.yyyy" data-e-current-text="Tänään" data-e-clear-text="Tyhjennä" data-e-close-text="Ok" data-e-name="date"><a data-ng-class="isHolderNotChangedLimitExeeded(territory, app) ? \'bg-danger\' : \'\'" data-tooltip="{{territory.taken | amTimeAgo}}">{{(territory.taken | date : \'dd.MM.yyyy\') || \'Ei merkintää\'}}</a></span></dd><dt>{{\'TYPE\' | translate}}</dt><dd><span data-editable-text="territory.type" data-e-name="territory.type" data-e-required>{{territory.type}}</span></dd><dt>{{\'NUMBER_OF_APARTMENTS\' | translate}}</dt><dd><span data-editable-number="territory.apartmentCount" data-e-name="territory.apartmentCount" data-e-required>{{territory.apartmentCount}}</span></dd><dt>{{\'ARCHIVED\' | translate}}</dt><dd><span data-editable-checkbox="territory.archived" data-e-title="Alue ei ole enää käytössä?">{{territory.archived ? \'Kyllä\' : \'Ei\'}}</span></dd><dt>{{\'NOT_COUNTED_WHEN_CALCULATING_POORLY_COVERED\' | translate}}</dt><dd><span data-editable-checkbox="territory.notCountedWhenCalculatingCoveredDuringLastYearTotal" data-e-title="{{\'NOT_COUNTED_WHEN_CALCULATING_POORLY_COVERED_2\' | translate}}"><a data-tooltip="Esimerkiksi puhelin- ja liikealueita ei yleensä lasketa vuoteen käymättömien alueiden joukkoon.">{{!territory.notCountedWhenCalculatingCoveredDuringLastYearTotal ? \'Kyllä\' : \'Ei\'}}</a></span></dd></dl><div class="no-print"><h4>{{\'Alueen kuvaus\' | translate}}</h4><pre style="white-space: pre-line" data-editable-textarea="territory.description" data-e-name="territory.description" data-e-required>{{territory.description}}</pre></div><div><div data-ng-show="editableForm.$visible"><button type="submit" class="btn btn-primary" data-ng-disabled="editableForm.$waiting">{{\'SAVE\' | translate}}</button> <button type="button" class="btn btn-default" data-ng-disabled="editableForm.$waiting" data-ng-click="editableForm.$cancel(); editableMap = false;">{{\'CANCEL\' | translate}}</button> <button type="button" class="btn btn-danger pull-right" data-ng-bootbox-title="Danger - Danger - Danger" data-ng-bootbox-custom-dialog="{{\'DELETING_TERRITORY\' | translate}} <strong>{{territory.territoryCode}}</strong>. {{\'ARE_YOU_SURE\' | translate}}" data-ng-bootbox-buttons="confirmButtonsDelete">{{\'DELETE\' | translate}}</button></div></div></form></div></div><div class="col-sm-6 no-print" data-ng-if="territory.territoryHolderHistory.length === 0"><h4>{{\'NO_HOLDER_HISTORY\' | translate}}</h4></div><div class="col-sm-6 no-print" data-ng-if="territory.territoryHolderHistory.length > 0"><h4>{{\'HISTORY\' | translate}} ({{territory.territoryHolderHistory.length}}) <span class="pull-right" data-ng-show="!deleteTerritoryHolderHistoryItemVisible && user.admin"><a href="#" class="no-print" data-ng-click="deleteTerritoryHolderHistoryItemVisible = true" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h4><table class="table table-condensed table-hover"><thead><tr><th class="col-xs-3">{{\'HOLDER\' | translate}}</th><th class="col-xs-2 text-nowrap">{{\'START_DATE\' | translate}}</th><th class="col-xs-2 text-nowrap">{{\'END_DATE\' | translate}}</th><th class="col-xs-4 text-nowrap">{{\'ADDITIONAL_INFO\' | translate}}</th><th class="col-xs-1 text-nowrap"></th></tr></thead><tbody data-ng-repeat="thh in territory.territoryHolderHistory"><tr><td><span data-ng-if="user.admin" data-editable-select="thh.holder" data-e-name="thh.holder.id" data-e-ng-options="holder.id as holder.name for holder in holders" data-e-required data-onaftersave="saveTerritoryHistoryItem(thh)">{{getHolderNameWithId(thh.holder)}}</span> <span data-ng-if="!user.admin"><a data-ui-sref="app.holder.single({id: thh.holder})">{{getHolderNameWithId(thh.holder)}}</a></span></td><td><span data-ng-if="user.admin" data-editable-bsdate="thh.startDate" data-e-ng-click="openPickers(\'thhStartDateOpened\')" data-e-is-open="pickers.thhStartDateOpened" data-e-datepicker-popup="dd.MM.yyyy" data-e-current-text="Tänään" data-e-clear-text="Tyhjennä" data-e-close-text="Ok" data-e-name="date" data-onaftersave="saveTerritoryHistoryItem(thh)">{{(thh.startDate | date : \'dd.MM.yyyy\') || \'Ei alkupäivää\'}}</span> <span data-ng-if="!user.admin">{{thh.startDate | date : \'dd.MM.yyyy\'}}</span></td><td><span data-ng-if="user.admin" data-editable-bsdate="thh.endDate" data-e-ng-click="openPickers(\'thhEndDateOpened\')" data-e-is-open="pickers.thhEndDateOpened" data-e-current-text="Tänään" data-e-clear-text="Tyhjennä" data-e-close-text="Ok" data-e-datepicker-popup="dd.MM.yyyy" data-onaftersave="saveTerritoryHistoryItem(thh)" data-e-name="date">{{(thh.endDate | date: \'dd.MM.yyyy\') || \'Ei loppupäivää\'}}</span> <span data-ng-if="!user.admin">{{thh.endDate | date: \'dd.MM.yyyy\'}}</span></td><td><span data-ng-if="user.admin" data-editable-text="thh.description" data-e-name="thh.description" data-onaftersave="saveTerritoryHistoryItem(thh)">{{thh.description || \'Ei kommenttia\'}}</span> <span data-ng-if="!user.admin">{{thh.description}}</span></td><td><a data-ng-show="deleteTerritoryHolderHistoryItemVisible" data-ng-click="setTerritoryHolderHistoryToBeDeleted(thh)" data-ng-bootbox-title="{{\'DELETING_TERRITORY_HISTORY_ROW\' | translate}}" data-ng-bootbox-custom-dialog="{{\'ARE_YOU_SURE\' | translate}}" data-ng-bootbox-buttons="confirmHistoryButtonsDelete"><span class="fa fa-trash fa-2x"></span></a></td></tr></tbody></table></div><div class="col-sm-6"><h4><span data-ng-if="territory.territoryLinkAttribute.length > 0">{{\'ATTRIBUTES\' | translate}} ({{territory.territoryLinkAttribute.length}})</span> <span data-ng-if="territory.territoryLinkAttribute.length === 0" class="no-print">{{\'NO_TERRITORY_ATTRIBUTES\' | translate}}</span> <span class="pull-right" data-ng-show="!deleteTerritoryLinkAttributeItemVisible && user.admin"><a href="#" class="no-print" data-ng-click="deleteTerritoryLinkAttributeItemVisible = true" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h4><table class="table table-condensed table-hover" data-ng-if="territory.territoryLinkAttribute.length > 0"><thead><tr><th class="col-xs-1"></th><th class="col-xs-3 text-nowrap">{{\'NAME\' | translate}}</th><th class="col-xs-7 text-nowrap">{{\'ATTRIBUTE_DESCRIPTION\' | translate}}</th><th class="col-xs-1 text-nowrap"></th></tr></thead><tbody data-ng-repeat="tla in territory.territoryLinkAttribute"><tr><td><span class="fa fa-{{getAttributeWithId(attributes, tla.attribute).icon}}"></span></td><td>{{getAttributeWithId(attributes, tla.attribute).name}}</td><td>{{getAttributeWithId(attributes, tla.attribute).description}}</td><td><a data-ng-show="deleteTerritoryLinkAttributeItemVisible" data-ng-click="setTerritoryLinkAttributeToBeDeleted(tla)" data-ng-bootbox-title="You are about to delete a territory attribute" data-ng-bootbox-custom-dialog="Are you sure about the territory attribute delete?" data-ng-bootbox-buttons="confirmAttributeButtonsDelete"><span class="fa fa-trash fa-2x"></span></a></td></tr></tbody></table><div data-ng-if="user.admin && deleteTerritoryLinkAttributeItemVisible"><div class="form-inline"><div class="form-group"><label for="newAttributeInput">{{\'ADD_ATTRIBUTE\' | translate}}</label><select id="newAttributeInput" class="form-control input-sm" ng-model="newAttribute" ng-options="a.name for a in attributes"></select></div><a class="btn btn-primary btn-sm" data-ng-click="addNewAttribute(newAttribute);">{{\'ADD\' | translate}}</a></div></div></div><div class="col-sm-6 no-print"><h4><span data-ng-if="territory.specialAddress.length > 0">Kieltopaikat ja vieraskieliset ({{territory.specialAddress.length}})</span> <span data-ng-if="territory.specialAddress.length === 0">Alueella ei ole kieltopaikkoja tai vieraskielisiä</span> <span class="pull-right" data-ng-show="!deleteSpecialAddressItemVisible && (user.admin || user.canAddSpecialAddresses)"><a href="#" class="no-print" data-ng-click="deleteSpecialAddressItemVisible = true" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h4><table class="table table-condensed table-hover" data-ng-if="territory.specialAddress.length > 0"><thead><tr><th class="col-xs-1 text-nowrap">Päiväys</th><th class="col-xs-4 text-nowrap">Nimi</th><th class="col-xs-5 text-nowrap">Osoite</th><th class="col-xs-1 text-nowrap">Tyyppi</th><th class="col-xs-1 text-nowrap"></th></tr></thead><tbody data-ng-repeat="sa in territory.specialAddress | filter : \'Kielto\'"><tr><td>{{sa.added | date : \'dd.MM.yyyy\'}}</td><td>{{sa.name}}</td><td>{{sa.address}}</td><td>{{sa.type}}</td><td><a data-ng-if="user.admin" data-ng-show="deleteSpecialAddressItemVisible" data-ng-click="setSpecialAddressToBeDeleted(sa)" data-ng-bootbox-title="Vahvista toiminto" data-ng-bootbox-custom-dialog="Oletko varma että haluat poistaa merkinnän?" data-ng-bootbox-buttons="confirmSpecialAddressButtonsDelete"><span class="fa fa-trash"></span></a></td></tr></tbody><tbody data-ng-repeat="sa in territory.specialAddress | filter : \'Vierask\'"><tr><td>{{sa.added | date : \'dd.MM.yyyy\'}}</td><td>{{sa.name}}</td><td>{{sa.address}}</td><td>{{sa.type}}</td><td><a data-ng-show="deleteSpecialAddressItemVisible" data-ng-click="setSpecialAddressToBeDeleted(sa)" data-ng-bootbox-title="Vahvista toiminto" data-ng-bootbox-custom-dialog="Oletko varma että haluat poistaa merkinnän?" data-ng-bootbox-buttons="confirmSpecialAddressButtonsDelete"><span class="fa fa-trash"></span></a></td></tr></tbody></table><div data-ng-if="deleteSpecialAddressItemVisible"><div class="form-inline"><div class="form-group"><label>Nimi: <input class="form-control input-sm" minlength="3" required maxlength="40" data-ng-model="specialAddress.name"></label><label>Osoite: <input class="form-control input-sm" minlength="3" maxlength="100" required data-ng-model="specialAddress.address"></label><label>Tyyppi:<select class="form-control input-sm" data-ng-model="specialAddress.type"><option value="">-</option><option value="Kielto">Kieltopaikka</option><option value="Vierask">Vieraskielinen</option></select></label><button class="btn btn-primary btn-sm" data-ng-click="addSpecialAddress(specialAddress);" data-ng-disabled="!specialAddress.name || !specialAddress.address || specialAddress.type == \'\'">{{\'ADD\' | translate}}</button></div></div></div></div></div><div data-ng-if="territory" class="no-print"><h4>Kartta <span class="pull-right" data-ng-show="!editableMap && user.admin"><a href="#" class="no-print" data-ng-click="toggleMapEditable()" data-tooltip="{{\'EDIT\' | translate}}"><i class="fa fa-wrench"></i></a></span></h4><a data-ng-show="editableMap" class="btn btn-danger pull-right" data-ng-click="replacePolylineWithDefault()">{{\'DELETE_BORDER\' | translate}}</a> <a data-ng-show="editableMap" class="btn btn-primary" data-ng-click="saveMap(map)">{{\'SAVE_MAP\' | translate}}</a><ui-gmap-google-map center="map.center" style="display: block" zoom="map.zoom"><ui-gmap-marker coords="map.territoryCenterMarker.coords" idkey="map.territoryCenterMarker.id" options="map.territoryCenterMarker.options" events="map.territoryCenterMarker.events"></ui-gmap-marker><ui-gmap-polygon editable="editableMap" static="false" ng-repeat="p in map.polygons track by p.id" path="p.path" stroke="p.stroke" visible geodesic="p.geodesic" fill="p.fill" fit="false" draggable events="map.polygonEvents"></ui-gmap-polygon></ui-gmap-google-map></div><p class="no-print">{{"Voit tulostaa aluekartan painamalla Ctrl+P" | translate}}</p><div class="col-print-12 print-only territoryMap" style="page-break-before: always"><img ng-src="{{imgSrc}}" alt="Alueen kartta puuttuu"></div>');
}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/auth/login/login.html",'<div class="form-login"><form name="loginForm" method="post" novalidate><h2 class="title">Kirjaudu sisään</h2><div class="form-group" data-show-errors><input name="username" class="form-control username" placeholder="käyttäjätunnus" autofocus autocomplete="off" required data-focus-on="username" data-ng-model="credentials.identifier"></div><div class="form-group" data-show-errors><input type="password" name="password" class="form-control password" placeholder="salasana" required data-ng-model="credentials.password"></div><button class="btn btn-primary btn-block" data-ng-click="login()" data-ng-disabled="!loginForm.$valid">Kirjaudu sisään</button></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/error/partials/error.html",'<h3>Hups! Havaittiin moka.</h3><p>Aluesovelluksen rattaat ovat menneet solmuun, pahoittelut. Jos ongelma toistuu, ota yhteyttä ylläpitäjiin.</p><p data-ng-show="error.fromState.name"><a href="#" data-ng-click="goToPrevious()">Palaa siihen mitä olit tekemässä</a></p>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/directives/partials/ListSearch.html",'<div><div class="list-search-filters list-search pull-right"><form class="form-inline mobile-hide" role="form"><div class="form-group"><input id="textFilters" class="form-control input-sm" placeholder="Hakutermit" data-ng-model="filters.searchWord"><select data-ng-if="holders.length" id="filtersHolderSelect" class="form-control input-sm" data-ng-model="filters.holderId" data-ng-options="holder.id as holder.name for holder in holders | filter : onlyActiveHolders"><option value="">-- valitse omistaja --</option></select><button data-ng-click="filters.searchWord = \'\'; filters.holderId = null; filters.attributeId = null" class="btn btn-xs" data-tooltip="Tyhjennä hakuehdot"><i class="fa fa-times text-info"></i></button><label>Rivejä:<select class="form-control input-sm" data-ng-model="items" data-ng-options="page for page in options"></select></label></div></form></div><form class="desktop-hide" role="form"><div class="form-group"><input id="textFilters" class="form-control" placeholder="Hakutermit" data-ng-model="filters.searchWord"><select data-ng-if="holders.length" id="filtersHolderSelect" class="form-control" data-ng-model="filters.holderId" data-ng-options="holder.id as holder.name for holder in holders | filter : onlyActiveHolders"><option value="">-- valitse omistaja --</option></select><label class="pull-right">Rivejä:<select class="input-sm" data-ng-model="items" data-ng-options="page for page in options"></select></label></div></form></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/directives/partials/territorySubPages.html",'<div class="row"><div class="col-xs-12"><ul class="list-inline pull-right"><li><a data-ui-sref="app.territory.stats" data-tooltip="Tilastot"><span class="fa fa-line-chart"></span> Tilastot</a></li><li><a data-ui-sref="app.territory.s13" data-tooltip="S-13"><span class="fa fa-history"></span> S-13</a></li><li><a data-ui-sref="app.territory.map" data-tooltip="Kartta"><span class="fa fa-map-marker"></span> {{\'MAP\' | translate}}</a></li><li><a data-ui-sref="app.territory.quickview" data-tooltip="Alueiden pikatarkastelu"><span class="fa fa-eye"></span> {{\'QUICK_VIEW\' | translate}}</a></li></ul></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/layout/partials/files.html",'<div><h4>Files used in this example</h4><p>Below you can see all the actual <em>backend / frontend</em> files which are used to make this example page work.</p><div class="row"><div class="col-xs-3" data-ng-repeat="(title, items) in filesJson"><h5 data-ng-bind-html="title"></h5><ul class="list-unstyled"><li data-ng-repeat="item in items"><a href="{{item.url}}" target="_blank" data-tooltip-html-unsafe="{{getTooltip(item)}}" data-tooltip-placement="left" data-ng-bind-html="item.title"></a></li></ul></div></div></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/layout/partials/footer.html",'<footer class="no-print mobile-hide"><div class="navbar navbar-default navbar-fixed-bottom"><div class="container"><ul class="nav navbar-nav"><li><a href="https://github.com/slmnn/tman2" target="_blank"><i class="fa fa-github"></i>GitHub</a></li><li><a href="https://github.com/slmnn/tman2/issues" target="_blank"><i class="fa fa-bug"></i>Raportoi ongelma</a></li><li><a href="http://tman2.slack.com" target="_blank"><i class="fa fa-slack"></i>Slack</a></li></ul></div></div></footer>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/layout/partials/header.html",'<header><div class="navbar navbar-default navbar-fixed-top no-print"><div class="container"><div class="navbar-header"><button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><div class="collapse navbar-collapse" id="navbar-main"><ul class="nav navbar-nav navbar-right"><li data-ui-sref-active="active" data-ng-show="auth.isAuthenticated()"><a href="#" data-ui-sref="profile.edit({id: user().id})"><span class="fa fa-user"></span> {{user().username}}</a></li><li data-ui-sref-active="active" data-ng-show="!auth.isAuthenticated()"><a href="#" data-ui-sref="auth.login"><span class="fa fa-sign-in"></span> Kirjaudu sisään</a></li><li data-ng-show="auth.isAuthenticated()"><a href="#" data-ng-click="logout()"><span class="fa fa-sign-out"></span> Kirjaudu ulos</a></li></ul><ul class="nav navbar-nav"><li class="{{item.class}}" data-ng-repeat="item in navigationItems" data-ng-show="auth.authorize(item.access)" data-ng-class="{\'not-active\': isNotActive(item), \'active\': isActive(item)}" data-ui-sref-active="active"><a href="#" data-ui-sref="{{item.state}}"><span data-ng-if="item.icon" class="fa {{item.icon}}"></span> {{item.title}}</a></li></ul></div></div></div></header>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/layout/partials/help.html",'<div class="modal-header"><button type="button" class="close" data-dismiss="modal" data-ng-click="dismiss()"><span aria-hidden="true">&times;</span> <span class="sr-only">Sulje</span></button><h3 class="modal-title">{{title}}</h3></div><div class="modal-body modal-help"><div data-ng-include="template"></div></div><div class="modal-footer"><button class="btn btn-primary btn-sm" data-ng-click="dismiss()">Sulje</button></div>')}])}(),function(t){try{t=angular.module("frontend-templates")}catch(e){t=angular.module("frontend-templates",[])}t.run(["$templateCache",function(t){t.put("/frontend/core/layout/partials/navigation.html",'<ul class="nav nav-tabs no-print top-buffer-sm"><li data-ng-repeat="item in navigationItems" data-ui-sref-active="active"><a data-ng-if="item.state" data-ng-show="auth.authorize(item.access)" data-ui-sref="{{item.state}}"><span data-ng-if="item.icon" class="fa {{item.icon}}"></span> {{item.title}}</a> <a style="text-decoration: line-through" data-ng-if="!item.state">{{item.title}}</a></li><li class="pull-right"><a href="#" class="help" data-ng-click="openInformation()">Sivun ohje <i class="fa fa-info-circle"></i></a></li></ul>')}])}(),function(){"use strict";angular.module("frontend.admin.login-history").controller("LoginHistoryController",["$scope","$timeout","$q","$filter","_","ListConfig","SocketHelperService","LoginHistoryModel","_items","_count","_statsBrowser","_statsOS","_statsUser",function(t,e,a,r,n,i,o,s,l,d,u,c,p){function m(){1===t.currentPage?f():t.currentPage=1}function f(){t.loading=!0;var e={where:o.getWhere(t.filters),populate:"user"},r={limit:t.itemsPerPage,skip:(t.currentPage-1)*t.itemsPerPage,sort:t.sort.column+" "+(t.sort.direction?"ASC":"DESC")},i=s.count(e).then(function(e){t.itemCount=e.count}),l=s.load(n.merge({},e,r)).then(function(e){t.items=e});a.all([i,l])["finally"](function(){t.loaded=!0,t.loading=!1})}s.setScope(t,!1,"items","itemCount"),t.statsBrowser=u,t.statsOS=c,t.statsUser=p,t=angular.extend(t,angular.copy(i.getConfig())),t.items=l,t.itemCount=d.count,t.titleItems=i.getTitleItems(s.endpoint),t.sort={column:"createdAt",direction:!1},t.filters={searchWord:"",columns:t.titleItems};var h={options:{chart:{type:"pie"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},exporting:{enabled:!1},tooltip:{formatter:function(){return"<strong>"+this.key+"</strong><br />Percentage: "+r("number")(this.point.percentage,2)+"%<br />Total: "+r("number")(this.y)},pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"}},title:{text:""},series:[{type:"pie",name:"",data:[]}]},g=[{scope:"chartBrowser",data:"statsBrowser",title:"Browsers"},{scope:"chartOs",data:"statsOS",title:"Operating systems"},{scope:"chartUser",data:"statsUser",title:"Users"}];n.forEach(g,function(e){t[e.scope]=angular.copy(h),t[e.scope].series[0].data=t[e.data],t[e.scope].title.text=e.title}),t.changeSort=function(e){var a=t.sort;a.column===e.column?a.direction=!a.direction:(a.column=e.column,a.direction=!0),m()},t.$watch("items",function(e,r){if(e!==r){var i=[{action:"Browser",scope:"chartBrowser"},{action:"OS",scope:"chartOs"},{action:"User",scope:"chartUser"}],o=n.map(i,function(e){s.statistics(e.action).then(function(a){t[e.scope].series[0].data=a})});a.all(o)}}),t.$watch("currentPage",function(t,e){t!==e&&f()}),t.$watch("itemsPerPage",function(t,e){t!==e&&m()});var y;t.$watch("filters",function(t,a){t!==a&&(y&&e.cancel(y),y=e(m,400))},!0),m()}])}(),function(){"use strict";angular.module("frontend.admin.login-history").factory("LoginHistoryModel",["$log","DataModel","DataService",function(t,e,a){var r=new e("userlogin");return r.statistics=function(e){var r=this;return a.collection(r.endpoint+"/statistics/",{type:e}).then(function(t){return t.data},function(a){t.error("LoginHistoryModel.statistics() failed.",a,r.endpoint,e)})},r}])}(),function(){"use strict";angular.module("frontend.admin.migrate").controller("MigrateController",["_","$scope","$state","UserModel","TerritoryModel","HolderModel","CoordinateModel","TerritoryHolderHistoryModel","_app","MessageService",function(t,e,a,r,n,i,o,s,l,d){var u,c,p=l[0],m=[],f=[],h=[],g=[];e.rollback=function(){t.each(f,function(t){n["delete"](t)}),t.each(m,function(t){i["delete"](t)}),t.each(h,function(t){o["delete"](t)}),t.each(g,function(t){s["delete"](t)})},e.parseMigrationHolders=function(e){c=JSON.parse(e.holders),t.each(c,function(t){i.create({name:t.name,email:t.email,emailValid:t.emailValid,isArchived:!1}).then(function(e){t.new_id=e.data.id,m.push(e.data.id)})})},e.parseMigrationTerritories=function(e){u=JSON.parse(e.territories),t.each(u,function(t){var e=c.filter(function(e){return e.id==t.holder})[0],a=e&&e.new_id?e.new_id:p.defaultHolder;o.create({latitude:t.lat,longitude:t.lng,type:"center"}).then(function(e){var r=e.data.id;h.push(e.data.id),n.create({territoryCode:t.territoryCode,lastCoveredTime:t.lastCoveredTime,notificationEmailDate:t.notificationEmailDate,taken:t.reallyTaken,covered:t.taken,description:t.description,holder:a,center:r,archived:!1,type:"Normal"==t.type?"Tavallinen":null,notCountedWhenCalculatingCoveredDuringLastYearTotal:"Normal"==t.type?!1:!0}).then(function(e){t.new_id=e.data.id,f.push(e.data.id),a!=p.defaultHolder&&s.create({holder:a,territory:t.new_id,startDate:t.reallyTaken}).then(function(t){g.push(t.data.id)})})})})}}])}(),function(){"use strict";angular.module("frontend.admin.request-log").controller("RequestLogController",["$scope","$q","$timeout","_","ListConfig","SocketHelperService","MessageService","RequestLogModel","UserService","_items","_count",function(t,e,a,r,n,i,o,s,l,d,u){function c(){1===t.currentPage?p():t.currentPage=1}function p(){t.loading=!0;var a={where:i.getWhere(t.filters),populate:"user"},n={limit:t.itemsPerPage,skip:(t.currentPage-1)*t.itemsPerPage,sort:t.sort.column+" "+(t.sort.direction?"ASC":"DESC")};console.log(n);var o=s.load(r.merge({},a,n)).then(function(e){t.items=e}),l=s.count(a).then(function(e){t.itemCount=e.count});e.all([l,o])["finally"](function(){t.loaded=!0,t.loading=!1})}s.setScope(t,!1,"items","itemCount"),t=angular.extend(t,angular.copy(n.getConfig())),t.items=d,t.user=l.user(),t.itemCount=u.count,t.titleItems=n.getTitleItems(s.endpoint),t.sort={column:"createdAt",direction:!1},t.filters={searchWord:"",columns:t.titleItems},t.changeSort=function(e){var a=t.sort;a.column===e.column?a.direction=!a.direction:(a.column=e.column,a.direction=!0),c()},t.$watch("currentPage",function(t,e){t!==e&&p()}),t.$watch("itemsPerPage",function(t,e){t!==e&&c()});var m;t.$watch("filters",function(t,e){t!==e&&(m&&a.cancel(m),m=a(c,400))},!0),c()}])}(),function(){"use strict";angular.module("frontend.admin.request-log").factory("RequestLogModel",["DataModel",function(t){return new t("requestLog")}])}(),function(){"use strict";angular.module("frontend.admin.user").controller("UserAddController",["$scope","$state","UserModel","_app","_holders","MessageService",function(t,e,a,r,n,i){a.setScope(t,"user"),t.app=r[0],t.holders=n;var o=function(){t.user={firstName:"",lastName:"",username:"",email:"",archived:!1,admin:!1}};o(),t.addUser=function(){var r=angular.copy(t.user);t.selectedHolderId&&(r.holder=t.selectedHolderId),a.create(r).then(function(t){200==t.status?i.success("Uusi käyttäjä lisättiin."):i.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")"),e.go("admin.user",{reload:!0})})}}]),angular.module("frontend.admin.user").controller("UserController",["$scope","$state","UserService","MessageService","UserModel","_user","_holders","_app",function(t,e,a,r,n,i,o,s){t.currentUser=a.user(),t.user=i,t.holders=o,t.saveUser=function(){var a=angular.copy(t.user);null!=a.holder&&a.holder.id!==s[0].defaultHolder.id?a.holder=a.holder.id:null!=a.holder&&a.holder.id===s[0].defaultHolder.id?a.holder=null:a.holder=null,n.update(a.id,a).then(function(a){200==a.status?r.success('Käyttäjän "'+t.user.username+'" tiedot päivitettiin.'):r.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+a.status+")"),e.go(e.current,{reload:!0})})}}]),angular.module("frontend.admin.user").controller("UsersController",["$scope","$timeout","$q","$filter","_","ListConfig","SocketHelperService","MessageService","UserService","UserModel","_items","_count",function(t,e,a,r,n,i,o,s,l,d,u,c){function p(){1===t.currentPage?m():t.currentPage=1}function m(){t.loading=!0;var e={where:o.getWhere(t.filters),populate:"user"},r={limit:t.itemsPerPage,skip:(t.currentPage-1)*t.itemsPerPage,sort:t.sort.column+" "+(t.sort.direction?"ASC":"DESC")},i=d.count(e).then(function(e){t.itemCount=e.count}),s=d.load(n.merge({},e,r)).then(function(e){t.items=e});a.all([i,s])["finally"](function(){t.loaded=!0,t.loading=!1})}d.setScope(t,!1,"items","itemCount"),t=angular.extend(t,angular.copy(i.getConfig())),t.items=u,t.itemCount=c.count,t.user=l.user(),t.titleItems=i.getTitleItems(d.endpoint),t.sort={column:"createdAt",direction:!1},t.filters={searchWord:"",columns:t.titleItems},t.changeSort=function(e){var a=t.sort;a.column===e.column?a.direction=!a.direction:(a.column=e.column,a.direction=!0),p()},t.$watch("currentPage",function(t,e){t!==e&&m()}),t.$watch("itemsPerPage",function(t,e){t!==e&&p()});var f;t.$watch("filters",function(t,a){t!==a&&(f&&e.cancel(f),f=e(p,400))},!0),p()}])}(),function(){"use strict";angular.module("frontend.admin.user").factory("UserModel",["DataModel",function(t){return new t("user")}])}(),function(){"use strict";angular.module("frontend.app.app").controller("AppController",["$scope","$state","UserService","MessageService","AppModel","_app","_holders",function(t,e,a,r,n,i,o){n.setScope(t,"app"),t.user=a.user(),t.app=i[0],t.holders=o,t.mapTypes=["hybrid","satellite","roadmap","terrain"],0===i.length&&n.create({lastBackup:new Date,backupInterval:7,backupEmail:"example.email.address@example.com",lastStats:new Date,notCoveredLimit:365,notCoveredWarningEmailLimit:100,holderNotChangedWarningLimit:200,holderChangePreventedIfLimitExeeded:!1,holderChangeToDefaultIfLimitExeeded:!1,printMapType:"hybrid",printMapLineColor:"0x00FF0066",printMapAreaFillColor:"0x00FF0022",printMapScale:1}).then(function(t){201==t.status?r.success("Sovellusasetukset tallennettiin."):r.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")"),e.go(e.current,{},{reload:!0})}),t.saveApp=function(){var a=angular.copy(t.app);a.defaultHolder={id:a.defaultHolder.id},n.update(a.id,a).then(function(t){200==t.status?r.success("Sovellusasetukset päivitettiin."):r.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")"),e.go(e.current,{},{reload:!0})})}}])}(),function(){"use strict";angular.module("frontend.app.app").service("AppModel",["DataModel",function(t){return new t("app")}])}(),function(){"use strict";angular.module("frontend.app.attribute").service("AttributeModel",["DataModel",function(t){return new t("attribute")}])}(),function(){"use strict";angular.module("frontend.app.attribute").controller("AttributesController",["$scope","$state","UserService","MessageService","AttributeModel","_attributes",function(t,e,a,r,n,i){n.setScope(t,"attribute"),t.user=a.user(),t.attributes=i,t.deleteAttribute=function(t){n["delete"](t.id).then(function(){r.success("Attribuutti poistettiin."),e.go(e.current,{},{reload:!0})})},t.createAttribute=function(t){var a=angular.copy(t);n.create(a).then(function(t){201==t.status?r.success("Uusi attribuutti luotiin."):r.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")"),e.go(e.current,{},{reload:!0})})},t.updateAttribute=function(t){var a=angular.copy(t);n.update(a.id,a).then(function(t){200==t.status?r.success("Attribuutti päivitettiin."):r.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")"),e.go(e.current,{},{reload:!0})})}}])}(),function(){"use strict";angular.module("frontend.app.chat").controller("ChatController",["$scope","$timeout","$localStorage","moment","MessageService","MessageModel","_messages",function(t,e,a,r,n,i,o){function s(){e(function(){document.getElementById("messages").scrollTop=50*t.messages.length})}t.messages=o,t.nick=a.chat&&a.chat.nick?a.chat.nick:"",t.message={nick:t.nick,message:""},t.nick&&t.nick.trim()&&s(),t.$watch("messages",function(t){t&&s()},!0),t.enterToChat=function(){t.nick&&""!==t.nick.trim()?(t.message.nick=t.nick,a.chat={nick:t.nick,time:r().format()},s()):n.error("Please provide some nick.")},t.leaveChat=function(){t.message.nick="",t.nick="",t.messages=[],a.chat={}},t.postMessage=function(){""!==t.message.message.trim()?i.create(t.message).then(function(){t.message.message="",s()}):n.error("Please enter some text to chat.")}}])}(),function(){"use strict";angular.module("frontend.app.chat").directive("chatScreen",["$timeout","$window",function(t,e){return{restrict:"C",link:function(t,a){var r=function(){var t=angular.element(e).height()-170;angular.element(a).css("height",t+"px")};angular.element(e).bind("resize",function(){r()}),r()}}}])}(),function(){"use strict";angular.module("frontend.app.chat").factory("MessageModel",["DataModel",function(t){var e=new t("message");return e.handlerCreated=function(t){this.objects.push(t.data)},e}])}(),function(){"use strict";angular.module("frontend.app.holder").controller("HolderAddController",["$scope","$state","MessageService","HolderModel",function(t,e,a,r){var n=function(){t.holder={name:"",email:"",emailValid:!0,isArchived:!1,territories:[]}};n(),t.addHolder=function(){var e=angular.copy(t.holder);r.create(e).then(function(t){201==t.status?a.success("Uusi alueomistaja luotiin."):a.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")"),n()})}}]),angular.module("frontend.app.holder").controller("HolderController",["$scope","$state","UserService","MessageService","TerritoryHelper","HolderModel","TerritoryModel","_holder","_app",function(t,e,a,r,n,i,o,s,l){i.setScope(t,"holder"),s.territories=_.sortBy(s.territories,function(t){return t.territoryCode?t.territoryCode:0}),t.user=a.user(),t.holder=s,t.app=l[0],t.territories=[],t.isNotCoveredLimitExeeded=function(t,e){return n.isNotCoveredRecently(t,e)},t.isHolderNotChangedLimitExeeded=function(t,e){return n.isHolderNotChangedLimitExeeded(t,e)},t.confirmButtonsDelete={ok:{label:"Poista",className:"btn-danger",callback:function(){t.deleteHolder()}},cancel:{label:"Peruuta",className:"btn-default pull-left"}},t.saveHolder=function(){var e=angular.copy(t.holder);e.isArchived=e.isArchived||!1,e.emailValid=e.emailValid||!0,delete e.territories,i.update(e.id,e).then(function(e){200==e.status?r.success('Alueomistajan "'+t.holder.name+'" tiedot päivitettiin.'):r.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+e.status+")")})},t.deleteHolder=function(){i["delete"](t.holder.id).then(function(){r.success('Alueomistaja "'+t.holder.name+'" poistettiin.'),e.go("app.holder")})},t.loadTerritorys=function(){return t.territorys.length?null:o.load().then(function(e){t.territorys=e})}}]),angular.module("frontend.app.holder").controller("HolderListController",["$scope","$q","$timeout","_","ListConfig","SocketHelperService","UserService","HolderModel","TerritoryModel","_items","_count",function(t,e,a,r,n,i,o,s,l,d,u){function c(){1===t.currentPage?p():t.currentPage=1}function p(){t.loading=!0;var a={where:i.getWhere(t.filters)},n={populate:"territories",limit:t.itemsPerPage,skip:(t.currentPage-1)*t.itemsPerPage,sort:t.sort.column+" "+(t.sort.direction?"ASC":"DESC")},o=s.count(a).then(function(e){t.itemCount=e.count}),l=s.load(r.merge({},a,n)).then(function(e){t.items=e});e.all([o,l])["finally"](function(){t.loaded=!0,t.loading=!1})}s.setScope(t,!1,"items","itemCount"),l.setScope(t,!1,"territories"),t=angular.extend(t,angular.copy(n.getConfig())),t.items=d,t.itemCount=u.count,t.user=o.user(),t.titleItems=n.getTitleItems(s.endpoint),t.sort={column:"name",direction:!0},t.filters={searchWord:"",columns:t.titleItems},t.changeSort=function(e){var a=t.sort;a.column===e.column?a.direction=!a.direction:(a.column=e.column,a.direction=!0),c()},t.getTerritory=function(e,a,n){n=n||"Unknown",a=a||!0;var i=r.find(t.territorys,function(t){return parseInt(t.id,10)===parseInt(e.toString(),10)});return i?a===!0?i:i[a]:n},t.$watch("currentPage",function(t,e){t!==e&&p()}),t.$watch("itemsPerPage",function(t,e){t!==e&&c()});var m;t.$watch("filters",function(t,e){t!==e&&(m&&a.cancel(m),m=a(c,400))},!0),c()}])}(),function(){"use strict";angular.module("frontend.app.holder").factory("HolderModel",["DataModel",function(t){return new t("holder")}])}(),function(){"use strict";angular.module("frontend.app.messages").controller("MessagesController",["$scope","$http","$sailsSocket","MessageService","BackendConfig",function(t,e,a,r,n){t.title="",t.message="",t.type="info",t.messageTypes=["info","success","warning","error"];var i=[n.url+"/Basdfasdf",n.url+"/Book/123123123"];t.showMessage=function(){r[t.type](t.message,t.title)},t.makeInvalidHttpRequest=function(t){e.get(i[t])},t.makeInvalidSailsSocketRequest=function(t){a.get(i[t])}}])}(),function(){"use strict";angular.module("frontend.app.territoryHolderHistory").service("TerritoryHolderHistoryModel",["DataModel",function(t){return new t("territoryHolderHistory")}])}(),function(){"use strict";angular.module("frontend.app.territory").controller("TerritoryAddController",["$scope","$state","$modalInstance","HolderModel","CoordinateModel","_holders","_app","MessageService","TerritoryModel",function(t,e,a,r,n,i,o,s,l){t.holders=i,t.app=o[0];var d=function(){t.territory={name:"",description:"",type:"",covered:new Date,taken:new Date},t.selectedHolder=t.app.defaultHolder};d(),t.dismiss=function(){a.dismiss()},t.datePickerOpened=function(t){t&&(t.preventDefault(),t.stopPropagation())},t.addTerritory=function(){var a=angular.copy(t.territory);t.selectedHolder?a.holder={id:t.selectedHolder}:a.holder=t.app.defaultHolder,l.create(a).then(function(a){201==a.status?(s.success("Uusi alue luotiin."),n.create({type:"center",latitude:t.map.territoryCenterMarker.coords.latitude,longitude:t.map.territoryCenterMarker.coords.longitude}).then(function(t){l.update(a.data.id,{center:t.data.id}).then(function(){s.success('Alueen "'+a.data.territoryCode+'" keskikohta asetettiin.')})})):s.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+a.status+")"),e.go(e.current,{reload:!0}),d()})},t.map={center:{latitude:t.app.defaultLatitude||61,longitude:t.app.defaultLongitude||23},zoom:13,territoryCenterMarker:{id:0,options:{draggable:!0},coords:{latitude:t.app.defaultLatitude||61,longitude:t.app.defaultLongitude||23},events:{dragend:function(){t.map.territoryCenterMarker.options={draggable:!0,labelContent:"lat: "+t.map.territoryCenterMarker.coords.latitude+" lon: "+t.map.territoryCenterMarker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"}}}}}}]),angular.module("frontend.app.territory").controller("TerritoryController",["$scope","$state","_","$timeout","UserService","MessageService","TerritoryModel","HolderModel","SpecialAddressModel","_territory","_holders","_app","_attributes","TerritoryHolderHistoryModel","TerritoryLinkAttributeModel","TerritoryHelper","CoordinateModel","uiGmapGoogleMapApi",function(t,e,a,r,n,i,o,s,l,d,u,c,p,m,f,h,g,y){o.setScope(t,"territory"),s.setScope(t,!1,"holders","holdersCount"),t.user=n.user(),d.territoryHolderHistory=a.sortBy(d.territoryHolderHistory,function(t){return t.startDate?Date.parse(t.startDate):0}),p=a.sortBy(p,function(t){return t.name?t.name:0}),t.territory=angular.copy(d),t.holders=u,t.attributes=p,t.app=c[0],t.pickers={},t.pickers.thhEndDateOpened=!1,t.pickers.thhStartDateOpened=!1,t.pickers.coveredDateOpened=!1,t.pickers.takenDateOpened=!1,t.openPickers=function(e){r(function(){t.pickers[e]=!0})},t.closePickers=function(e){r(function(){t.pickers[e]=!0})},t.isNotCoveredLimitExeeded=function(t,e){return h.isNotCoveredRecently(t,e)},t.isHolderNotChangedLimitExeeded=function(t,e){return h.isHolderNotChangedLimitExeeded(t,e)};var v=[],b=a.sortBy(d.coordinates,"order");if(a.each(b,function(t){v.push(t)}),t.map={center:t.territory.center||{latitude:t.app.defaultLatitude,longitude:t.app.defaultLongitude},zoom:16,territoryCenterMarker:{id:t.territory.center?t.territory.center.id:0,options:{draggable:!1},coords:t.territory.center||{latitude:t.app.defaultLatitude,longitude:t.app.defaultLongitude},events:{dragend:function(){t.map.territoryCenterMarker.options={draggable:!0,labelContent:"lat: "+t.map.territoryCenterMarker.coords.latitude+" lon: "+t.map.territoryCenterMarker.coords.longitude,labelAnchor:"100 0",labelClass:"marker-labels"}}}},polygons:[{id:1,path:v,stroke:{color:"#33CDDC",weight:3},editable:!0,draggable:!1,geodesic:!0,visible:!0,fill:{color:"#33CCCC",opacity:.2}}]},t.map.center.coordinates=[],t.imgSrc="",v.length>0){for(var k="",C=0;C<v.length;C++)k+=v[C].latitude+","+v[C].longitude+"%7C";k+=v[0].latitude+","+v[0].longitude,t.imgSrc="https://maps.googleapis.com/maps/api/staticmap?size=600x400&markers=color:blue%7C"+t.territory.center.latitude+","+t.territory.center.longitude+"&maptype="+t.app.printMapType+"&path=fillcolor:"+t.app.printMapAreaFillColor+"%7Ccolor:"+t.app.printMapLineColor+"%7Cweight:5%7C"+k+"&scale="+t.app.printMapScale+"&key=AIzaSyDFdn9_nl-V2VywY_VsaZJmeXImTifATRQ"}else t.imgSrc="https://maps.googleapis.com/maps/api/staticmap?size=600x400&markers=color:blue%7C"+t.territory.center.latitude+","+t.territory.center.longitude+"&maptype="+t.app.printMapType+"&scale="+t.app.printMapScale+"&key=AIzaSyDFdn9_nl-V2VywY_VsaZJmeXImTifATRQ";t.editableMap=!1,t.toggleMapEditable=function(){r(function(){t.editableMap=!t.editableMap,t.map.territoryCenterMarker.options.draggable=!t.map.territoryCenterMarker.options.draggable})},t.replacePolylineWithDefault=function(){T(angular.copy(t.territory.coordinates)),t.map.polygons[0].path=[],t.map.polygons[0].path.push({latitude:t.map.center.latitude+5e-4,longitude:t.map.center.longitude+5e-4,order:t.map.polygons[0].path.length}),t.map.polygons[0].path.push({latitude:t.map.center.latitude+5e-4,longitude:t.map.center.longitude-5e-4,order:t.map.polygons[0].path.length}),t.map.polygons[0].path.push({latitude:t.map.center.latitude-5e-4,longitude:t.map.center.longitude-5e-4,order:t.map.polygons[0].path.length}),t.map.polygons[0].path.push({latitude:t.map.center.latitude-5e-4,longitude:t.map.center.longitude+5e-4,order:t.map.polygons[0].path.length}),t.saveMap(t.map)};var T=function(t){var e=[];a.each(t,function(t){t.id&&e.push(g["delete"](t.id))}),Promise.all(e).then(function(t){i.success("Alueen kartta nollattiin.")})};t.saveMap=function(){var r={latitude:t.map.territoryCenterMarker.coords.latitude,longitude:t.map.territoryCenterMarker.coords.longitude,type:"center",order:0},n=[];if(t.map.territoryCenterMarker&&t.map.territoryCenterMarker.id&&0!==t.map.territoryCenterMarker.id?n.push(g.update(t.map.territoryCenterMarker.id,r)):n.push(g.create(r).then(function(e){o.update(t.territory.id,{center:e.data.id}).then(function(){i.success('Alueen "'+t.territory.territoryCode+'" keskikohta päivitettiin.')})})),t.map.polygons[0]){var s=[],l=[];a.each(t.map.polygons[0].path,function(e,a){s.push({type:"border",territory:t.territory.id,latitude:e.latitude,longitude:e.longitude,order:a}),e.id&&l.push(e.id)}),a.each(l,function(t){n.push(g["delete"](t))}),a.each(s,function(t){n.push(g.create(t))})}Promise.all(n).then(function(a){i.success("Alueen kartta päivitettiin."),t.toggleMapEditable(),e.go(e.current,{id:d.id},{reload:!0})})},t.saveTerritoryHistory=function(){a.each(t.territory.territoryHolderHistory,function(e){t.saveTerritoryHistoryItem(e)}),r(function(){e.go(e.current,{id:d.id},{reload:!0})},2e3)},t.onlyActiveHolders=function(t){return t.isArchived?!1:!0},t.saveTerritoryHistoryItem=function(t){m.update(t.id,{startDate:t.startDate,endDate:t.endDate,description:t.description,holder:t.holder}).then(function(t){200==t.status?i.success("Aluehistoriatieto päivitettiin."):i.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+t.status+")")})};var A=null;t.setTerritoryHolderHistoryToBeDeleted=function(t){A=t.id},t.confirmHistoryButtonsDelete={ok:{label:"Poista",className:"btn-danger",callback:function(){m["delete"](A).then(function(){i.success("Aluehistoriatieto poistettiin."),A=null,t.deleteTerritoryHolderHistoryItemVisible=!1,e.go(e.current,{id:d.id},{reload:!0})})}},cancel:{label:"Peruuta",className:"btn-default pull-left",callback:function(){A=null}}},t.confirmButtonsDelete={ok:{label:"Poista",className:"btn-danger",callback:function(){t.deleteTerritory()}},cancel:{label:"Peruuta",className:"btn-default pull-left"}},t.saveTerritory=function(){var r=angular.copy(t.territory);if(r.holder=r.holder.id||t.app.defaultHolder,!d.holder||r.holder!==d.holder.id){var n=new Date;if(r.territoryHolderHistory&&r.territoryHolderHistory.length>0&&!a.last(r.territoryHolderHistory).endTime&&m.update(a.last(r.territoryHolderHistory).id,{endDate:n}),r.holder!==t.app.defaultHolder){var s={startDate:n,holder:r.holder,territory:r.id};m.create(s).then(function(e){201==e.status?i.success('Aluehistoriatieto alueelle "'+t.territory.territoryCode+'" luotiin.'):i.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+e.status+")");
})}}delete r.territoryHolderHistory,delete r.specialAddress,delete r.center,delete r.coordinates,delete r.territoryLinkAttribute,o.update(r.id,r).then(function(a){200==a.status?i.success('Alue "'+t.territory.territoryCode+'" päivitettiin.'):i.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+a.status+")"),e.go(e.current,{id:d.id},{reload:!0})})},t.deleteTerritory=function(){o["delete"](t.territory.id).then(function(){i.success('Alue "'+t.territory.territoryCode+'" poistettiin.'),e.go("app.territory")})},t.getHolderNameWithId=function(t){return a.result(a.find(u,function(e){return e.id===t}),"name")},t.getAttributeWithId=function(t,e){return a.find(t,function(t){return t.id===e})},t.addNewAttribute=function(a){f.create({attribute:a.id,territory:d.id}).then(function(){i.success('Attribuutti "'+a.name+'" lisättiin.'),t.deleteTerritoryLinkAttributeItemVisible=!1,e.go(e.current,{id:d.id},{reload:!0})})};var S=null;t.setSpecialAddressToBeDeleted=function(t){S=t.id};var w=null;t.setTerritoryLinkAttributeToBeDeleted=function(t){w=t.id},t.addSpecialAddress=function(a){a.territory=d.id,a.added=new Date,l.create(a).then(function(){i.success("Merkintä kieltopaikasta tai vieraskielisestä osoitteesta lisättiin."),t.deleteSpecialAddressItemVisible=!1,e.go(e.current,{id:d.id},{reload:!0})})},t.confirmSpecialAddressButtonsDelete={ok:{label:"Poista",className:"btn-danger",callback:function(){l["delete"](S).then(function(){i.success("Merkintä poistettiin"),S=null,t.deleteSpecialAddressItemVisible=!1,e.go(e.current,{id:d.id},{reload:!0})})}},cancel:{label:"Peruuta",className:"btn-default pull-left",callback:function(){S=null}}},t.confirmAttributeButtonsDelete={ok:{label:"Delete",className:"btn-danger",callback:function(){f["delete"](w).then(function(){i.success("Attribuutti poistettiin"),w=null,t.deleteTerritoryLinkAttributeItemVisible=!1,e.go(e.current,{id:d.id},{reload:!0})})}},cancel:{label:"Cancel",className:"btn-default pull-left",callback:function(){w=null}}}}]),angular.module("frontend.app.territory").controller("TerritoryListController",["$scope","$q","$timeout","$ngBootbox","_","ListConfig","TerritoryHelper","MessageService","MailService","TerritoryLinkAttributeModel","TerritoryHolderHistoryModel","SocketHelperService","UserService","TerritoryModel","_items","_count","_holders","_app","_attributes",function(t,e,a,r,n,i,o,s,l,d,u,c,p,m,f,h,g,y,v){function b(){t.clearSelected(t.items),1===t.currentPage?k():t.currentPage=1}function k(){t.loading=!0;var a={where:c.getWhere(t.filters)};t.filters&&t.filters.holderId&&(a.where=n.merge({},a.where,{holder:t.filters.holderId})),t.filters&&t.filters.attributeLinkId;var r={populate:["holder","territoryHolderHistory","territoryLinkAttribute"],limit:t.itemsPerPage,skip:(t.currentPage-1)*t.itemsPerPage,sort:t.sort.column+" "+(t.sort.direction?"ASC":"DESC")},i=m.count(a).then(function(e){t.itemCount=e.count});console.log(n.merge({},a,r));var o=m.load(n.merge({},a,r)).then(function(e){t.items=e});e.all([i,o])["finally"](function(){t.loaded=!0,t.loading=!1})}m.setScope(t,!1,"items","itemCount"),t=angular.extend(t,angular.copy(i.getConfig())),t.items=f,t.holders=g,t.attributes=v,t.app=y[0],t.itemCount=h.count,t.user=p.user(),t.titleItems=i.getTitleItems(m.endpoint),t.sort={column:"territoryCode",direction:!0},t.filters={searchWord:"",columns:t.titleItems},t.getLastTerritoryHolderHistory=function(t){return t.territoryHolderHistory=n.sortBy(t.territoryHolderHistory,function(t){return t.startDate?Date.parse(t.startDate):0}),n.last(t.territoryHolderHistory)},t.addAttributeLink=function(t,e){d.create({territory:t.id,attribute:e}).then(function(e){201==e.status?s.success("Attribuutti lisättiin alueelle "+t.territoryCode):s.info("Odottamaton tulos. Toiminto saattoi epäonnistua ("+e.status+")"),k()})},t.updateApartmentCount=function(t,e){m.update(t.id,{apartmentCount:e}).then(function(e){200==e.status?s.success("Päivitettiin alueen "+t.territoryCode+" asuntojen lukumäärä."):s.info("Odottamaton tulos. Toiminto saattoi epäonnistua ("+e.status+")"),k()})};var C=function(){var e=new Date(t.app.lastBackup),a=new Date;t.suggestBackup=!1,a.getTime()-e.getTime()>24*t.app.backupInterval*60*60*1e3&&(t.suggestBackup=!0)};a(C,50),t.runBackup=function(){l.backup().then(function(){s.success("Tiedot varmuuskopioitiin."),C()})};var T=function(){l.count().then(function(e){t.mails=e.data,t.mailsTotal=e.data.new_territory_taken_emails+e.data.territory_removed_emails+e.data.not_covered_territory_emails})};a(T,50),t.sendNotificationEmails=function(){l.send(null).then(function(t){console.log(t),s.success("Sähköpostiviestit lähetettiin."),T()})},t.onlyCheckedTerritories=function(t){return t.checked},t.onlyActiveHolders=function(t){return t.isArchived?!1:!0},t.onlyAllowedHolders=function(e){return t.user.holder&&e.id!==t.user.holder&&!t.isDefaultHolder(e.id)?!1:!0},t.isDefaultHolder=function(e){return e===t.app.defaultHolder},t.selectedHolder=t.app.defaultHolder,t.selectedTerritoryHolderId=null,t.territoryChecked=function(e,a){t.territoryOperationChange(),t.selectedTerritoryHolderId=e.holder.id,t.isDefaultHolder(e.holder.id)?t.operation="3":t.operation=null;var r=!1;n.each(a,function(t){t.checked===!0&&(r=!0)}),r||(t.selectedTerritoryHolderId=null)},t.removeSearchWord=function(e,a){var r=e.split(" ");r.splice(a,1),t.filters.searchWord=r.join(" ")},t.clearSelected=function(e){n.each(e,function(t){t.checked=!1}),t.isCollapsed=!0,t.isAllCollapsed=!1,t.selectedTerritoryHolderId=null},t.getHolderNameWithId=function(t,e){if(t&&e){var a=n.find(t,function(t){return t.id===e});return a.name}return""},t.getAttributeWithId=function(t,e){if(t&&e){var a=n.find(t,function(t){return t.id===e});return a}return null},t.getAttributeWithId=function(t,e){return n.find(t,function(t){return t.id===e})},t.territoryOperationChange=function(e){t.selectedHolder=t.app.defaultHolder},t.selectionDisabledFilter=function(e){return e.archived?!0:null!==t.selectedTerritoryHolderId&&t.selectedTerritoryHolderId==e.holder.id?t.user.holder&&e.holder.id!==t.app.defaultHolder&&e.holder.id!==t.user.holder?!0:!1:null===t.selectedTerritoryHolderId?t.user.holder&&e.holder.id!==t.app.defaultHolder&&e.holder.id!==t.user.holder?!0:!1:!0};var A=function(e,a,r){var i=[];return r!==t.app.defaultHolder&&i.push(u.create({startDate:new Date,holder:r,territory:e.id,description:a}).then(function(t){201!=t.status&&s.error("Aluehistoriatiedon lisäys epäonnistui alueelle "+e.territoryCode)})),e.territoryHolderHistory&&e.territoryHolderHistory.length>0&&!n.last(e.territoryHolderHistory).endTime&&i.push(u.update(n.last(e.territoryHolderHistory).id,{endDate:new Date}).then(function(t){200!=t.status&&s.error("Aluehistoriatiedon muutos epäonnistui alueelle "+e.territoryCode)})),i};t.markTerritoriesAsCovered=function(t,e){var a=[];n.each(t,function(t){a.push(m.update(t.id,{covered:new Date})),A(t,e,t.holder.id)}),S(a)},t.changeHolder=function(t,e,a,r){var i=!1;if(n.each(t,function(t){t.holder&&t.holder.id==a&&(s.error("Yksi valituista alueista, "+t.territoryCode+", on jo merkitty tälle omistajalle."),i=!0)}),!i){var o=[];n.each(t,function(t){if(!t.holder||t.holder!=a&&t.holder.id!=a){var n={taken:new Date,holder:a};e&&(n.covered=new Date),o.push(m.update(t.id,n)),A(t,r,a)}}),S(o)}};var S=function(e){Promise.all(e).then(function(t){var e="Muutettiin alueita: ",a="Muutos ei onnistunut alueille: ",r="";n.each(t,function(t){200==t.status&&(r+=t.data.territoryCode+" ")}),r.length>0&&s.success(e+r);var i="";n.each(t,function(t){200!=t.status&&(i+=t.data.territoryCode+" ")}),i.length>0&&s.error(a+i)}),t.isCollapsed=!0,t.isAllCollapsed=!1,t.selectedTerritoryHolderId=null,T(),k()};t.isNotCoveredLimitExeeded=function(t,e){return o.isNotCoveredRecently(t,e)},t.isHolderNotChangedLimitExeeded=function(t,e){return o.isHolderNotChangedLimitExeeded(t,e)},t.changeSort=function(e){var a=t.sort;a.column===e.column?a.direction=!a.direction:(a.column=e.column,a.direction=!0),b()},t.$watch("currentPage",function(t,e){t!==e&&k()}),t.$watch("itemsPerPage",function(t,e){t!==e&&b()});var w;t.$watch("filters",function(t,e){t!==e&&(w&&a.cancel(w),w=a(b,400))},!0),b()}]),angular.module("frontend.app.territory").controller("TerritoryStatsController",["$scope","$q","_","ListConfig","SocketHelperService","UserService","StatModel","_items","_app","_stats",function(t,e,a,r,n,i,o,s,l,d){var u=function(t){var e=864e5,a=t/e,r=a/30,n=r/12;return a%=30,r%=12,{days:Math.floor(a),months:Math.floor(r),years:Math.floor(n)}};t.territories=s,t.app=l[0],t.user=i.user(),t.totalCount=0,t.notCoveredRecently=0,t.totalWithoutNotCountedWhenCalculatingCoveredDuringLastYearTotal=0,t.holderIsDefault=0,t.totalNotCountedWhenCalculatingCoveredDuringLastYearTotal=0,t.totalNotCountedWhenCalculatingCoveredDuringLastYearTotalNotCovered=0,t.averageCoveredTime=0;var c=0,p=0,m=0;t.averageTimeBetweenHolderChange=0,t.holderChanges=0,t.territoryTypeCounts=[];var f=new Date,h=864e5*(t.app.notCoveredLimit||365);a.each(t.territories,function(e){if(t.holderChanges+=e.territoryHolderHistory?e.territoryHolderHistory.length:0,a.each(e.territoryHolderHistory,function(t){var e=new Date(Date.parse(t.startDate||f)),a=new Date(Date.parse(t.endDate||f));c+=a.getTime()-e.getTime()}),e.holder!==t.app.defaultHolder&&!e.archived){var r=new Date(Date.parse(e.taken||f));p+=f.getTime()-r.getTime(),m++}var n=new Date(Date.parse(e.covered));f.getTime()-n.getTime()>h&&!e.notCountedWhenCalculatingCoveredDuringLastYearTotal&&!e.archived&&t.notCoveredRecently++,e.archived||t.totalCount++,e.notCountedWhenCalculatingCoveredDuringLastYearTotal&&!e.archived&&(t.totalNotCountedWhenCalculatingCoveredDuringLastYearTotal++,f.getTime()-n.getTime()>h&&t.totalNotCountedWhenCalculatingCoveredDuringLastYearTotalNotCovered++),e.holder===t.app.defaultHolder&&t.holderIsDefault++});var g=c/t.holderChanges,y=u(g);t.averageCoveredTime=y.days+" päivää, "+y.months+" kuukautta ja "+y.years+" vuotta.";var v=p/m,b=u(v);t.averageTimeSameHolder=b.days+" päivää, "+b.months+" kuukautta ja "+b.years+" vuotta.",o.create({statisticDate:new Date,averageCoveredTime:g,averageHoldingTime:v,totalCount:t.totalCount,notCoveredCount:t.notCoveredRecently,availableCount:t.holderIsDefault})}]),angular.module("frontend.app.territory").controller("TerritoryS13Controller",["$scope","$q","_","ListConfig","SocketHelperService","UserService","_items","_holders",function(t,e,a,r,n,i,o,s){t.territories=o,t.holders=s,t.user=i.user(),a.each(t.territories,function(t){var e=20-t.territoryHolderHistory.length;e=e>0?e:0,t.emptyArray=Array.apply(null,Array(e)).map(function(t,e){return e})}),t.getHolderNameWithId=function(t){return a.result(a.find(s,function(e){return e.id===t}),"name")}}]),angular.module("frontend.app.territory").controller("TerritoryQuickViewController",["$scope","$q","_","ListConfig","TerritoryHelper","SocketHelperService","UserService","_items","_holders","_app",function(t,e,a,r,n,i,o,s,l,d){t=angular.extend(t,angular.copy(r.getConfig())),t.territories=s,t.holders=l,t.app=d[0],t.user=o.user(),t.isNotCoveredRecently=function(t,e){return n.isNotCoveredRecently(t,e)},t.isDefaultHolder=function(e){return e===t.app.defaultHolder},t.getHolderNameWithId=function(t){return a.result(a.find(l,function(e){return e.id===t}),"name")}}]),angular.module("frontend.app.territory").controller("TerritoryMapController",["$scope","$q","$filter","_","ListConfig","TerritoryHelper","SocketHelperService","UserService","_items","_app",function(t,e,a,r,n,i,o,s,l,d){t=angular.extend(t,angular.copy(n.getConfig())),t.territories=l,t.app=d[0],t.user=s.user(),t.map={center:{latitude:t.app.defaultLatitude||t.app.defaultLatitude,longitude:t.app.defaultLongitude||t.app.defaultLongitude},zoom:10,markersEvents:{},window:{marker:{},show:!1,closeClick:function(){this.show=!1},options:{},title:""}};var u=function(e,a,r){t.map.window.model=r,t.map.window.title=r.title,t.map.window.linkId=r.id,t.map.window.covered=r.covered,t.map.window.show=!0};t.map.markersEvents.click=u,t.onClick=function(e){t.selectedMarker=e.model};var c=function(e){try{return i.isNotCoveredRecently(e,t.app)?e.holder.id!==t.app.defaultHolder?"/assets/images/red.png":"/assets/images/red-dot.png":e.holder.id!==t.app.defaultHolder?"/assets/images/green.png":"/assets/images/green-dot.png"}catch(a){return"/assets/images/yellow.png"}};t.closeClick=function(){this.window=!1},t.territoryMarkers=[],r.each(t.territories,function(e){e.markerOptions={icon:{url:c(e)}},t.territoryMarkers.push({id:e.id,title:e.territoryCode,covered:e.covered,latitude:e.center?e.center.latitude:61,longitude:e.center?e.center.longitude:23,icon:e.markerOptions.icon,onClick:function(){console.log("Clicked",this)}})})}])}(),function(){"use strict";angular.module("frontend.app.territory").service("TerritoryModel",["DataModel",function(t){return new t("territory")}])}(),angular.module("frontend.app.territory").factory("TerritoryHelper",[function(){var t=864e5;return{isNotCoveredRecently:function(e,a){var r=t*a.notCoveredLimit,n=new Date;return Date.parse(e.covered)<n.getTime()-r},isHolderNotChangedLimitExeeded:function(e,a){var r=t*a.holderNotChangedWarningLimit,n=new Date;return Date.parse(e.taken)<n.getTime()-r}}}]),function(){"use strict";angular.module("frontend.core.auth.login",[]),angular.module("frontend.core.auth.login").config(["$stateProvider",function(t){t.state("auth.login",{url:"/login",data:{access:0},views:{"content@":{templateUrl:"/frontend/core/auth/login/login.html",controller:"LoginController"}}})}])}(),function(){"use strict";angular.module("frontend.core.auth.services").factory("AuthService",["$http","$state","$localStorage","AccessLevels","BackendConfig","MessageService",function(t,e,a,r,n,i){return{authorize:function(t){return t===r.user?this.isAuthenticated():t===r.admin?this.isAuthenticated()&&Boolean(a.credentials.user.admin):t===r.anon},isAuthenticated:function(){return Boolean(a.credentials)},login:function(e){return t.post(n.url+"/login",e,{withCredentials:!0}).then(function(t){i.success("Sisäänkirjautuminen onnistui."),a.credentials=t.data})},logout:function(){a.$reset(),i.success("Uloskirjautuminen onnistui."),e.go("auth.login")}}}])}(),function(){"use strict";angular.module("frontend.core.auth.services").factory("UserService",["$localStorage",function(t){return{user:function(){return t.credentials?t.credentials.user:{}}}}])}(),function(){"use strict";angular.module("frontend.core.components").directive("focusOn",["$timeout",function(t){return function(e,a){e.$on("focusOn",function(e,r){a.data("focusOn")&&r===a.data("focusOn")&&t(function(){a.focus()},0,!1)})}}]),angular.module("frontend.core.components").factory("FocusOnService",["$rootScope","$timeout",function(t,e){return{focus:function(a){e(function(){t.$broadcast("focusOn",a)},0,!1)}}}])}(),function(){"use strict";angular.module("frontend.core.directives").directive("listSearch",function(){return{restrict:"E",scope:{filters:"=",holders:"=",attributes:"=",items:"=",options:"="},replace:!0,templateUrl:"/frontend/core/directives/partials/ListSearch.html",controller:["$scope",function(t){t.id=Math.floor(6*Math.random()+1),t.inSearch=function(t){return angular.isUndefined(t.searchable)?!1:t.searchable}}]}})}(),function(){"use strict";angular.module("frontend.core.error").controller("ErrorController",["$scope","$state","_","_error",function(t,e,a,r){return a.isUndefined(r)?e.go("auth.login"):(t.error=r,void(t.goToPrevious=function(){e.go(t.error.fromState.name,t.error.fromParams)}))}])}(),function(){"use strict";angular.module("frontend.core.interceptors").factory("AuthInterceptor",["$q","$injector","$localStorage",function(t,e,a){return{request:function(t){var e;return a.credentials&&(e=a.credentials.token),e&&(t.data||(t.data={}),t.data.token=e,t.headers.authorization="Bearer "+e),t},responseError:function(r){return 401===r.status&&(a.$reset(),e.get("$state").go("auth.login")),t.reject(r)}}}])}(),function(){"use strict";angular.module("frontend.core.interceptors").factory("ErrorInterceptor",["$q","$injector",function(t,e){return{response:function(e){return e.data.error&&e.data.status&&200!==e.data.status?t.reject(e):e||t.when(e)},responseError:function(a){var r="";return a.data&&a.data.error?r=a.data.error:a.data&&a.data.message?r=a.data.message:(r="string"==typeof a.data?a.data:a.statusText?a.statusText:e.get("HttpStatusService").getStatusCodeText(a.status),r=r+' <span class="text-small">(HTTP status '+a.status+")</span>"),r&&e.get("MessageService").error(r),t.reject(a)}}}])}(),function(){"use strict";angular.module("frontend.core.layout").controller("HeaderController",["$scope","$state","HeaderNavigationItems","UserService","AuthService",function(t,e,a,r,n){t.user=r.user,t.auth=n,t.navigationItems=a,t.isNotActive=function(t){return!("examples"!==t.state||"examples.about"!==e.current.name)},t.isActive=function(t){var a=e.current.name.toString().split(".");return!(t.state!==e.current.name&&(t.state!==a[0]||"examples.about"===e.current.name))},t.logout=function(){n.logout()}}]),angular.module("frontend.core.layout").controller("FooterController",[function(){}]),angular.module("frontend.core.layout").controller("NavigationController",["$scope","$state","$modal","_items","AuthService",function(t,e,a,r,n){t.navigationItems=r,t.auth=n,t.openInformation=function(){a.open({templateUrl:"/frontend/core/layout/partials/help.html",controller:"NavigationModalController",size:"lg",resolve:{_title:function(){return e.current.views["content@"].name},_files:["NavigationInfoModalFiles",function(t){return t.get(e.current.name.toString())}],_template:function(){return e.current.views["content@"].templateUrl.replace(".html","-info.html")}}})}}]),angular.module("frontend.core.layout").controller("NavigationModalController",["$scope","$modalInstance","BackendConfig","_title","_files","_template",function(t,e,a,r,n,i){t.title=r,t.files=n,t.template=i,t.backendConfig=a,t.dismiss=function(){e.dismiss()}}])}(),function(){"use strict";angular.module("frontend.core.layout").directive("pageInfoFiles",function(){return{restrict:"E",replace:!0,scope:{files:"@"},templateUrl:"/frontend/core/layout/partials/files.html",controller:["$scope",function(t){try{t.filesJson=angular.fromJson(t.files)}catch(e){t.filesJson=!1}t.getTooltip=function(t){return'<h5 class="title">'+t.title+"</h5>"+t.info}}]}})}(),function(){"use strict";angular.module("frontend.core.layout").factory("HeaderNavigationItems",["AccessLevels",function(t){return[{state:"app.about",title:"Etusivu",access:t.anon,icon:"fa-home"},{state:"app",title:"Aluehallinta",access:t.user,icon:"fa-map-o"},{state:"admin",title:"Käyttäjät",access:t.admin,icon:"fa-users"}]}]),angular.module("frontend.core.layout").factory("ContentNavigationItems",["AccessLevels",function(t){var e={app:[{state:"app.territory",title:"Alueet",access:t.user,icon:"fa-list"},{state:"app.holder",title:"Alueomistajat",access:t.user,icon:"fa-street-view"},{state:"app.attributes",title:"Attribuutit",access:t.admin,icon:"fa-flag"},{state:"app.settings",title:"Aluehallinnan asetukset",access:t.admin,icon:"fa-cogs"}],admin:[{state:"admin.user",title:"Käyttäjät",access:t.admin},{state:"admin.login-history",title:"Kirjautumiset",access:t.admin},{state:"admin.request-log",title:"Taustakyselyt",access:t.admin},{state:"admin.migrate",title:"Migraatio",access:t.admin}]};return{getItems:function(t){return e[t]}}}]),angular.module("frontend.core.layout").factory("NavigationInfoModalFiles",["_",function(t){var e="https://github.com/tarlepp/angular-sailsjs-boilerplate/blob/master/",a={generic:{controller:"Used controller.",data:"Initial data that is loaded to database at first time that sails lift.",model:"Used model.",template:"Used HTML template."},backend:{baseController:"Generic base controller that is extended by real controllers.",baseModel:"Generic base model that is extended by real models.",policy:{authenticated:"Authentication policy that will check if request contains correct JWT or not.",passport:"Policy to initialize passport.js library to use."}},frontend:{module:"Current angular module configuration.",modelFactory:"Generic model factory that all individual models uses. This contains default functions for each model.",dataService:"Generic data service, which handles all the communications between back- and frontend via $sailsSocket service.",listConfig:"Service that contains all list specified configurations (title items, default configurations, etc.).",backendConfig:'Backend config, this contains backend url and other "static" backend specified definitions.',authInterceptor:"Authentication interceptor, that attach JWT to $http and $sailsSockets requests.",errorInterceptor:"Generic error interceptor, this will handle all error situations and shows those to user.",directive:"Used directive(s) in this example page."}},r={backend:{'Backend <span class="text-muted">generic</span>':[{url:e+"backend/api/base/controller.js",title:"controller.js",info:a.backend.baseController},{url:e+"backend/api/base/model.js",title:"model.js",info:a.backend.baseModel},{url:e+"backend/api/policies/Authenticated.js",title:"Authenticated.js",info:a.backend.policy.authenticated},{url:e+"backend/api/policies/Passport.js",title:"Passport.js",info:a.backend.policy.passport}]},frontend:{'Frontend <span class="text-muted">generic</span>':[{url:e+"frontend/src/app/core/services/ListConfigService.js",title:"ListConfigService.js",info:a.frontend.listConfig},{url:e+"frontend/src/app/core/models/factory.js",title:"factory.js",info:a.frontend.modelFactory},{url:e+"frontend/src/app/core/services/DataService.js",title:"DataService.js",info:a.frontend.dataService},{url:e+"frontend/src/app/core/constants/BackendConfig.js",title:"BackendConfig.js",info:a.frontend.backendConfig},{url:e+"frontend/src/app/core/interceptors/AuthInterceptor.js",title:"AuthInterceptor.js",info:a.frontend.authInterceptor},{url:e+"frontend/src/app/core/interceptors/ErrorInterceptor.js",title:"ErrorInterceptor.js",info:a.frontend.errorInterceptor}]}},n={"app.holder":{Backend:[{url:e+"backend/api/models/Holder.js",title:"Holder.js",info:a.generic.model},{url:e+"backend/api/controllers/HolderController.js",title:"HolderController.js",info:a.generic.controller},{url:e+"backend/test/fixtures/Holder.json",title:"Holder.json",info:a.generic.data}],Frontend:[{url:e+"frontend/src/app/app/holder/holder.js",title:"holder.js",info:a.frontend.module},{url:e+"frontend/src/app/app/holder/holder-controllers.js",title:"holder-controllers.js",info:a.generic.controller},{url:e+"frontend/src/app/app/holder/holder-models.js",title:"holder-models.js",info:a.generic.model},{url:e+"frontend/src/app/app/holder/list.html",title:"list.html",info:a.generic.template}]},"app.territory":{Backend:[{url:e+"backend/api/models/Territory.js",title:"Territory.js",info:a.generic.model},{url:e+"backend/api/controllers/TerritoryController.js",title:"TerritoryController.js",info:a.generic.controller},{url:e+"backend/test/fixtures/Territory.json",title:"Territory.json",info:a.generic.data}],Frontend:[{url:e+"frontend/src/app/app/territory/territory.js",title:"territory.js",info:a.frontend.module},{url:e+"frontend/src/app/app/territory/territory-controllers.js",title:"territory-controllers.js",info:a.generic.controller},{url:e+"frontend/src/app/app/territory/territory-models.js",title:"territory-models.js",info:a.generic.model},{url:e+"frontend/src/app/app/territory/list.html",title:"list.html",info:a.generic.template}]},"app.messages":{Frontend:[{url:e+"frontend/src/app/app/messages/messages.js",title:"messages.js",info:a.frontend.module},{url:e+"frontend/src/app/app/messages/messages-controllers.js",title:"messages-controllers.js",info:a.generic.controller},{url:e+"frontend/src/app/app/messages/messages.html",title:"messages.html",info:a.generic.template}],'Frontend <span class="text-muted">generic</span>':[{url:e+"frontend/src/app/core/interceptors/ErrorInterceptor.js",title:"ErrorInterceptor.js",info:a.frontend.errorInterceptor},{url:e+"frontend/src/app/core/services/MessageService.js",title:"MessageService.js",info:"Service to show messages to users via <em>toastr</em> service."},{url:e+"frontend/src/app/core/services/HttpStatusService.js",title:"HttpStatusService.js",info:"Generic HTTP status service that contains helper methods for HTTP status code handling."}]},"app.chat":{Backend:[{url:e+"backend/api/models/Message.js",title:"Message.js",info:a.generic.model},{url:e+"backend/api/controllers/MessageController.js",title:"MessageController.js",info:a.generic.controller}],Frontend:[{url:e+"frontend/src/app/app/chat/chat.js",title:"chat.js",info:a.frontend.module},{url:e+"frontend/src/app/app/chat/chat-controllers.js",title:"chat-controllers.js",info:a.generic.controller},{url:e+"frontend/src/app/app/chat/chat-directives.js",title:"chat-directives.js",info:a.frontend.directive},{url:e+"frontend/src/app/app/chat/chat-models.js",title:"chat-models.js",info:a.generic.model},{url:e+"frontend/src/app/app/chat/chat.html",title:"chat.html",info:a.generic.template}]}};return{getAll:function(){return n},get:function(e){var a=n[e];switch(e){case"app.holder":case"app.territory":case"app.chat":a=t.merge(a,r.backend,r.frontend)}return a}}}])}(),function(){"use strict";angular.module("frontend.core.libraries").factory("_",["$window",function(t){return t._}])}(),function(){"use strict";angular.module("frontend.core.models").factory("DataModel",["$sailsSocket","$log","_","DataService",function(t,e,a,r){var n=function(t){this.object={},this.objects=[],this.cache={count:{},fetch:{},load:{}},this.scope=!1,this.itemNames={object:!1,objects:!1,count:!1},t?(this.endpoint=t,this._subscribe()):this.endpoint=!1};return n.prototype.setEndpoint=function(t){var e=this;e.endpoint=t,e._subscribe()},n.prototype.setScope=function(t,e,a,r){var n=this;n.scope=t,n.itemNames={object:e||!1,objects:a||!1,count:r||!1}},n.prototype.handlerCreated=function(t){var a=this;e.log("Object created",a.endpoint,t),a.scope&&(a.itemNames.objects&&a.load(null,!0),a.itemNames.count&&a.count(null,!0))},n.prototype.handlerUpdated=function(t){var a=this;e.log("Object updated",a.endpoint,t),a.scope&&(a.itemNames.object&&parseInt(t.id,10)===parseInt(a.object.id,10)&&a.fetch(null,null,!0),a.itemNames.objects&&a.load(null,!0))},n.prototype.handlerDeleted=function(t){var a=this;e.log("Object deleted",a.endpoint,t),a.scope&&(a.itemNames.object&&parseInt(t.id,10)===parseInt(a.object.id,10)&&e.warn("How to handle this case?"),a.itemNames.objects&&a.load(null,!0),a.itemNames.count&&a.count(null,!0))},n.prototype.handlerAddedTo=function(t){var a=this;e.log("AddedTo",a.endpoint,t)},n.prototype.handlerRemovedFrom=function(t){var a=this;e.log("RemovedFrom",a.endpoint,t)},n.prototype.count=function(t,a){var n=this;return t=t||{},a=a||!1,a?t=n.cache.count.parameters:n.cache.count={parameters:t},r.count(n.endpoint,t).then(function(t){return a&&n.scope&&n.itemNames.count&&(n.scope[n.itemNames.count]=t.data.count),t.data},function(a){e.error("DataModel.count() failed.",a,n.endpoint,t)})},n.prototype.load=function(t,a){var n=this;return t=t||{},a=a||!1,a?t=n.cache.load.parameters:n.cache.load={parameters:t},r.collection(n.endpoint,t).then(function(t){return n.objects=t.data,a&&n.scope&&n.itemNames.objects&&(n.scope[n.itemNames.objects]=n.objects),n.objects},function(a){e.error("DataModel.load() failed.",a,n.endpoint,t)})},n.prototype.fetch=function(t,a,n){var i=this;return a=a||{},n=n||!1,n?(t=i.cache.fetch.identifier,a=i.cache.fetch.parameters):i.cache.fetch={identifier:t,parameters:a},r.fetch(i.endpoint,t,a).then(function(t){return i.object=t.data,n&&i.scope&&i.itemNames.object&&(i.scope[i.itemNames.object]=i.object),i.object},function(r){e.error("DataModel.fetch() failed.",r,i.endpoint,t,a)})},n.prototype.create=function(t){var a=this;return r.create(a.endpoint,t).then(function(t){return t},function(r){e.error("DataModel.create() failed.",r,a.endpoint,t)})},n.prototype.update=function(t,a){var n=this;return r.update(n.endpoint,t,a).then(function(t){return t},function(r){e.error("DataModel.update() failed.",r,n.endpoint,t,a)})},n.prototype["delete"]=function(t){var a=this;return r["delete"](a.endpoint,t).then(function(t){return t},function(r){e.error("DataModel.delete() failed.",r,a.endpoint,t)})},n.prototype._subscribe=function(){var e=this;t.subscribe(e.endpoint,function(t){e._handleEvent(t)})},n.prototype._handleEvent=function(t){var r=this,n="handler"+t.verb[0].toUpperCase()+t.verb.slice(1);a.isFunction(r[n])?r[n](t):e.log("Implement handling for '"+t.verb+"' socket messages")},n}])}(),function(){"use strict";angular.module("frontend.core.services").factory("DataService",["$sailsSocket","_","BackendConfig",function(t,e,a){function r(t,r){return e.isUndefined(r)||(t=t+"/"+r),a.url+"/"+t}function n(t){return t=t||{},{params:t}}return{count:function(e,a){return t.get(r(e)+"/count/",n(a))},collection:function(e,a){return t.get(r(e),n(a))},fetch:function(e,a,i){return t.get(r(e,a),n(i))},create:function(e,a){return t.post(r(e),a)},update:function(e,a,n){return t.put(r(e,a),n)},"delete":function(e,a){return t["delete"](r(e,a))}}}])}(),function(){"use strict";angular.module("frontend.core.services").factory("HttpStatusService",function(){return{getStatusCodeText:function(t){var e="";switch(parseInt(t.toString(),10)){case 100:e="Continue";break;case 101:e="Switching Protocols";break;case 102:e="Processing (WebDAV; RFC 2518)";break;case 200:e="OK";break;case 201:e="Created";break;case 202:e="Accepted";break;case 203:e="Non-Authoritative Information (since HTTP/1.1)";break;case 204:e="No Content";break;case 205:e="Reset Content";break;case 206:e="Partial Content";break;case 207:e="Multi-Status (WebDAV; RFC 4918)";break;case 208:e="Already Reported (WebDAV; RFC 5842)";break;case 226:e="IM Used (RFC 3229)";break;case 300:e="Multiple Choices";break;case 301:e="Moved Permanently";break;case 302:e="Found";break;case 303:e="See Other";break;case 304:e="Not Modified";break;case 305:e="Use Proxy";break;case 306:e="Switch Proxy";break;case 307:e="Temporary Redirect";break;case 308:e="Permanent Redirect (Experimental RFC; RFC 7238)";break;case 400:e="Bad Request";break;case 401:e="Unauthorized";break;case 402:e="Payment Required";break;case 403:e="Forbidden";break;case 404:e="Not Found";break;case 405:e="Method Not Allowed";break;case 406:e="Not Acceptable";break;case 407:e="Proxy Authentication Required";break;case 408:e="Request Timeout";break;case 409:e="Conflict";break;case 410:e="Gone";break;case 411:e="Length Required";break;case 412:e="Precondition Failed";break;case 413:e="Request Entity Too Large";break;case 414:e="Request-URI Too Long";break;case 415:e="Unsupported Media Type";break;case 416:e="Requested Range Not Satisfiable";break;case 417:e="Expectation Failed";break;case 418:e="I'm a teapot (RFC 2324)";break;case 419:e="Authentication Timeout (not in RFC 2616)";break;case 420:e="Method Failure (Spring Framework) / Enhance Your Calm (Twitter)";break;case 422:e="Unprocessable Entity (WebDAV; RFC 4918)";break;case 423:e="Locked (WebDAV; RFC 4918)";break;case 424:e="Failed Dependency (WebDAV; RFC 4918)";break;case 426:e="Upgrade Required";break;case 428:e="Precondition Required (RFC 6585)";break;case 429:e="Too Many Requests (RFC 6585)";break;case 431:e="Request Header Fields Too Large (RFC 6585)";break;case 440:e="Login Timeout (Microsoft)";break;case 444:e="No Response (Nginx)";break;case 449:e="Retry With (Microsoft)";break;case 450:e="Blocked by Windows Parental Controls (Microsoft)";break;case 451:e="Unavailable For Legal Reasons (Internet draft) / Redirect (Microsoft)";break;case 494:e="Request Header Too Large (Nginx)";break;case 495:e="Cert Error (Nginx)";break;case 496:e="No Cert (Nginx)";break;case 497:e="HTTP to HTTPS (Nginx)";break;case 498:e="Token expired/invalid (Esri)";break;case 499:e="Client Closed Request (Nginx) / Token required (Esri)";break;case 500:e="Internal Server Error";break;case 501:e="Not Implemented";break;case 502:e="Bad Gateway";break;case 503:e="Service Unavailable";
break;case 504:e="Gateway Timeout";break;case 505:e="HTTP Version Not Supported";break;case 506:e="Variant Also Negotiates (RFC 2295)";break;case 507:e="Insufficient Storage (WebDAV; RFC 4918)";break;case 508:e="Loop Detected (WebDAV; RFC 5842)";break;case 509:e="Bandwidth Limit Exceeded (Apache bw/limited extension)";break;case 510:e="Not Extended (RFC 2774)";break;case 511:e="Network Authentication Required (RFC 6585)";break;case 520:e="Origin Error (Cloudflare)";break;case 521:e="Web server is down (Cloudflare)";break;case 522:e="Connection timed out (Cloudflare)";break;case 523:e="Proxy Declined Request (Cloudflare)";break;case 524:e="A timeout occurred (Cloudflare)";break;case 598:e="Network read timeout error (Unknown)";break;case 599:e="Network connect timeout error (Unknown)";break;default:e="Unknown HTTP status '"+t+"', what is this?"}return e}}})}(),function(){"use strict";angular.module("frontend.core.services").factory("ListConfig",["_",function(t){var e={territory:[{title:"Koodi",column:"territoryCode","class":"col-xs-1",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Tyyppi",column:"type","class":"col-xs-1 mobile-hide",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Käyty",column:"covered","class":"col-xs-1",searchable:!1,sortable:!0,inSearch:!1,inTitle:!0},{title:"Omistajalle",column:"taken","class":"col-xs-1 mobile-hide",searchable:!1,sortable:!0,inSearch:!1,inTitle:!0},{title:"Attribuutit",column:!1,"class":"col-xs-1 mobile-hide",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0},{title:"Kuvaus",column:"description","class":"col-xs-4 mobile-hide",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Omistaja",column:!1,"class":"col-xs-2",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0},{title:"Valinta",column:!1,"class":"text-center",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0}],holder:[{title:"Nimi",column:"name","class":"col-xs-3",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Sähköposti",column:"email","class":"col-xs-3 mobile-hide",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Puhelin",column:"telephone","class":"col-xs-2 mobile-hide",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Kuvaus",column:"description","class":"col-xs-4 text-left",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Alueita",column:!1,"class":"col-xs-1 text-left",searchable:!1,sortable:!0,inSearch:!1,inTitle:!0}],requestLog:[{title:"Aika",column:"createdAt","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Metodi",column:"method","class":"col-xs-1",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Url",column:"url","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Sisältö",column:"body","class":"col-xs-3",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Käyttäjänimi",column:"user","class":"col-xs-2",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0},{title:"Nimi",column:"firstName","class":"col-xs-1",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0},{title:"Tyyppi",column:"user","class":"col-xs-2",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0}],userlogin:[{title:"IP-osoite",column:"ip","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Selain",column:"browser","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Käyttöjärjestelmä",column:"os","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Käyttäjänimi",column:!1,"class":"col-xs-2",searchable:!1,sortable:!1,inSearch:!1,inTitle:!0},{title:"Kirjautumisaika",column:"createdAt","class":"col-xs-4",searchable:!1,sortable:!0,inSearch:!1,inTitle:!0}],user:[{title:"Etunimi",column:"firstName","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Sukunimi",column:"lastName","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Käyttäjänimi",column:"username","class":"col-xs-1",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Sähköposti",column:"email","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Tyyppi",column:"admin","class":"col-xs-2",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0},{title:"Luotu",column:"createdAt","class":"col-xs-3",searchable:!0,sortable:!0,inSearch:!0,inTitle:!0}]};return{getConfig:function(){return{itemCount:0,items:[],itemsPerPage:10,itemsPerPageOptions:[10,25,50,100],currentPage:1,where:{},loading:!0,loaded:!1}},getTitleItems:function(a){return t.isUndefined(e[a])?[]:e[a]}}}])}(),function(){"use strict";angular.module("frontend.core.services").factory("MailService",["$sailsSocket","BackendConfig",function(t,e){return{count:function(){return t.get(e.url+"/mail/count")},send:function(a){return t.post(e.url+"/mail/send",a)},backup:function(){return t.post(e.url+"/mail/backup",null)}}}])}(),function(){"use strict";angular.module("frontend.core.services").factory("MessageService",["toastr","_",function(t,e){function a(a,r,n,i,o){r=r||"",n=n||{},t[o](a,r,e.assign(i,n))}var r={};return r.success=function(t,e,r){var n={timeOut:2e3};a(t,e,r,n,"success")},r.info=function(t,e,r){var n={timeout:3e3};a(t,e,r,n,"info")},r.warning=function(t,e,r){var n={timeout:3e3};a(t,e,r,n,"warning")},r.error=function(t,e,r){var n={timeout:4e3};a(t,e,r,n,"error")},r}])}(),function(){"use strict";angular.module("frontend.core.services").factory("PasswordService",["$sailsSocket","BackendConfig",function(t,e){return{updatePassword:function(a){return t.post(e.url+"/user/password",a)}}}])}(),function(){"use strict";angular.module("frontend.core.services").factory("SocketHelperService",["_",function(t){return{getWhere:function(e,a){var r=a||{},n=t.filter(e.columns,function(t){return t.inSearch}),i=e.searchWord&&e.searchWord.length>0?t.filter(e.searchWord.split(" ")):[];if(n.length>0&&i.length>0){var o=[];t.forEach(n,function(e){t.forEach(i,function(t){var a={};a[e.column]={contains:t},o.push(a)})}),r={or:o}}return r}}}])}(),function(){"use strict";angular.module("frontend.profile",[]),angular.module("frontend.profile").controller("ProfileController",["$scope","$state","$http","UserService","MessageService","PasswordService","UserModel","_user",function(t,e,a,r,n,i,o,s){o.setScope(t,"user"),t.currentUser=r.user(),t.user=s,t.saveUser=function(){var e=angular.copy(t.user);o.update(e.id,e).then(function(e){200==e.status?n.success('Käyttäjä "'+t.user.username+'" päivitettiin.'):n.info("Odottamaton tulos, toiminto saattoi epäonnistua ("+e.status+")")})},t.saveNewPassword=function(){var e={userid:s.id,password1:t.password1};i.updatePassword(e).then(function(){n.success('Käyttäjän "'+t.user.username+'" salasana asetettiin.'),t.password2=""},function(e){n.error('Käyttäjän "'+t.user.username+'" salasanan tallennus epäonnistui.')})}}])}(),function(){"use strict";angular.module("frontend.admin",["frontend.admin.login-history","frontend.admin.migrate","frontend.admin.user","frontend.admin.request-log"]),angular.module("frontend.admin").config(["$stateProvider",function(t){t.state("admin",{parent:"frontend",data:{access:2},views:{"content@":{controller:["$state",function(t){t.go("admin.login-history")}]},"pageNavigation@":{templateUrl:"/frontend/core/layout/partials/navigation.html",controller:"NavigationController",resolve:{_items:["ContentNavigationItems",function(t){return t.getItems("admin")}]}}}})}])}(),function(){"use strict";angular.module("frontend.app",["frontend.app.about","frontend.app.territory","frontend.app.territoryHolderHistory","frontend.app.holder","frontend.app.coordinate","frontend.app.territoryLinkAttribute","frontend.app.specialAddress","frontend.app.attribute","frontend.app.app","frontend.app.stat","frontend.app.chat","frontend.app.messages"]),angular.module("frontend.app").config(["$stateProvider",function(t){t.state("app",{parent:"frontend",data:{access:1},views:{"content@":{controller:["$state",function(t){t.go("app.territory")}]},"pageNavigation@":{templateUrl:"/frontend/core/layout/partials/navigation.html",controller:"NavigationController",resolve:{_items:["ContentNavigationItems",function(t){return t.getItems("app")}]}}}})}])}(),function(){"use strict";angular.module("frontend.core.auth",["frontend.core.auth.login","frontend.core.auth.services"]),angular.module("frontend.core.auth").config(["$stateProvider",function(t){t.state("auth",{"abstract":!0,parent:"frontend",data:{access:1}})}])}(),function(){"use strict";angular.module("frontend.core.auth.login").controller("LoginController",["$scope","$state","AuthService","FocusOnService",function(t,e,a,r){function n(){r.focus("username"),t.credentials={identifier:"",password:""}}a.isAuthenticated()&&e.go("app.territory"),t.login=function(){a.login(t.credentials).then(function(){e.go("app.territory")},function(){n()})},n()}])}(),function(){"use strict";angular.module("frontend.core",["frontend.core.dependencies","frontend.core.auth","frontend.core.components","frontend.core.directives","frontend.core.error","frontend.core.filters","frontend.core.interceptors","frontend.core.layout","frontend.core.libraries","frontend.core.models","frontend.core.services","frontend.core.i18n"])}(),function(){"use strict";angular.module("frontend",["frontend-templates","frontend.core","frontend.app","frontend.profile","frontend.admin"]),angular.module("frontend").config(["$stateProvider","$locationProvider","$urlRouterProvider","$httpProvider","$sailsSocketProvider","$tooltipProvider","cfpLoadingBarProvider","toastrConfig","AccessLevels",function(t,e,a,r,n,i,o,s,l){r.defaults.useXDomain=!0,delete r.defaults.headers.common["X-Requested-With"],r.interceptors.push("AuthInterceptor"),r.interceptors.push("ErrorInterceptor"),angular.forEach(r.interceptors,function(t){n.interceptors.push(t)}),i.options({appendToBody:!0}),o.includeSpinner=!1,o.latencyThreshold=200,angular.extend(s,{allowHtml:!0,closeButton:!0,extendedTimeOut:3e3}),e.html5Mode({enabled:!0,requireBase:!1}).hashPrefix("!"),t.state("profile",{"abstract":!0,template:"<ui-view/>",parent:"frontend",data:{access:l.user}}).state("profile.edit",{url:"/profile/:id",views:{"content@":{templateUrl:"/frontend/profile/profile.html",controller:"ProfileController",resolve:{_user:["$stateParams","UserModel",function(t,e){return e.fetch(t.id)}]}}}}),t.state("frontend",{"abstract":!0,views:{header:{templateUrl:"/frontend/core/layout/partials/header.html",controller:"HeaderController"},footer:{templateUrl:"/frontend/core/layout/partials/footer.html",controller:"FooterController"}}}),a.otherwise("/login")}]).config(["uiGmapGoogleMapApiProvider",function(t){t.configure({key:"AIzaSyCEGiaZcIX3dFBOH5KLfrv6R8lvL-bdujQ",v:"3.24",libraries:"weather,geometry,visualization"})}]),angular.module("frontend").run(["$rootScope","$state","$injector","editableOptions","AuthService",function(t,e,a,r,n){r.theme="bs3",r.icon_set="font-awesome",t.$on("$stateChangeStart",function(t,a){n.authorize(a.data.access)||(t.preventDefault(),e.go("auth.login"))}),t.$on("$stateChangeError",function(t,r,n,i,o,s){return t.preventDefault(),a.get("MessageService").error("Virhe sivua ladattaessa."),e.get("error").error={event:t,toState:r,toParams:n,fromState:i,fromParams:o,error:s},console.log(s),e.go("error")})}])}(),function(){"use strict";angular.module("frontend").constant("AccessLevels",{anon:0,user:1,admin:2})}(),function(){"use strict";angular.module("frontend").constant("BackendConfig",{url:window.io.sails.url})}();